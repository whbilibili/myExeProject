<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成员管理</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
        /* 保持现有样式... */
    </style>
</head>
<body class="bg-gray-100">
    <div class="flex h-screen bg-white">
        <!-- 左侧部门树 (结构简化示意) -->
        <aside class="w-64 border-r border-gray-200 p-4 overflow-y-auto">
            <div class="mb-4">
                <input type="text" placeholder="输入关键词" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500">
            </div>
            <ul>
                <li class="mb-1">
                    <details>
                        <summary class="cursor-pointer text-sm font-medium text-gray-700 py-1 flex justify-between items-center group">
                            <span>▶ 质效技术部</span>
                            <button class="opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600 text-xs">...</button>
                        </summary>
                        <ul class="pl-4">
                            <!-- 子部门... -->
                        </ul>
                    </details>
                </li>
                <li class="mb-1">
                     <details>
                        <summary class="cursor-pointer text-sm font-medium text-gray-700 py-1 flex justify-between items-center group">
                            <span>▶ 外卖</span>
                            <button class="opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600 text-xs">...</button>
                        </summary>
                     </details>
                </li>
                <li class="mb-1">
                     <details open>
                        <summary class="cursor-pointer text-sm font-medium text-gray-700 py-1 flex justify-between items-center group">
                            <span>▼ 履约</span>
                             <button class="opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600 text-xs">...</button>
                        </summary>
                         <ul class="pl-4">
                             <li class="mb-1">
                                 <a href="#" class="block text-sm text-gray-600 py-1 px-2 rounded hover:bg-gray-100 bg-blue-100 text-blue-700 font-medium">部门11</a>
                             </li>
                              <li class="mb-1">
                                 <a href="#" class="block text-sm text-gray-600 py-1 px-2 rounded hover:bg-gray-100">部门22</a>
                             </li>
                         </ul>
                     </details>
                </li>
                <!-- More departments -->
            </ul>
        </aside>

        <!-- 右侧主内容区 -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- 顶部 Tab -->
            <div class="border-b border-gray-200 px-6">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <a href="#" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">全部成员</a>
                    <a href="#" class="border-blue-500 text-blue-600 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" aria-current="page">企业成员</a>
                    <a href="#" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">非企业成员</a>
                    <a href="#" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">虚拟角色管理</a>
                </nav>
            </div>

            <!-- 操作栏和成员列表 -->
            <div class="flex-1 overflow-y-auto p-6">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <input type="checkbox" id="show-sub-dept" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                        <label for="show-sub-dept" class="ml-2 text-sm text-gray-700">显示子部门成员</label>
                    </div>
                    <div class="flex items-center space-x-4">
                        <input type="text" placeholder="请输入搜索关键字" class="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 w-64">
                        <button class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                            <!-- Search Icon --> <svg class="h-4 w-4 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path></svg> 搜索
                        </button>
                        <button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">+ 邀请成员</button>
                        <button class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">+ 添加成员</button>
                        <button class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">批量导入</button>
                        <button class="inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100">批量删除</button>
                    </div>
                </div>

                <!-- 成员表格 -->
                <div class="shadow border-b border-gray-200 sm:rounded-lg overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">成员名称</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">归属部门</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">手机号</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">邮箱号</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">直属上级</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">加入时间</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">权限</th>
                                <!-- New Column -->
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">有效权限</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <!-- 示例行 -->
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">施帆 <span class="ml-1 px-1.5 py-0.5 text-xs font-medium text-blue-800 bg-blue-100 rounded">负责人</span></td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">质效技术部</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">18973708906</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">eofbdl02dp7@h...</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">柘榕汕</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2021-02-28 10:30</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">成员</span>
                                </td>
                                <!-- New Cell -->
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-blue-600">
                                    <button class="hover:underline" onclick="openPermissionsModal('user', '施帆', 'user-123')">查看</button>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600">
                                    <button class="hover:underline">删除成员</button>
                                </td>
                            </tr>
                             <!-- More rows... -->
                             <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">元信峰</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">质效技术部</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">13351282242</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">ud6dfir5w59@1...</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">孟欣欣</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2021-02-28 10:30</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">成员</span>
                                </td>
                                 <!-- New Cell -->
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-blue-600">
                                     <button class="hover:underline" onclick="openPermissionsModal('user', '元信峰', 'user-456')">查看</button>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600">
                                     <button class="hover:underline">删除成员</button>
                                </td>
                            </tr>
                             <!-- ... -->
                        </tbody>
                    </table>
                </div>
                <!-- 分页 -->
                 <nav class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6" aria-label="Pagination">
                    <div class="hidden sm:block">
                        <p class="text-sm text-gray-700">
                            共 <span class="font-medium">200</span> 条
                        </p>
                    </div>
                    <div class="flex-1 flex justify-between sm:justify-end">
                         <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">上一页</a>
                        <!-- Pagination numbers -->
                        <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 ml-3">下一页</a>
                    </div>
                </nav>
            </div>
        </main>
    </div>

    <!-- 权限详情模态框容器 -->
    <div id="permissions-modal-container"></div>

    <script>
        // 简单的模态框打开函数 (实际需要更复杂的实现来加载内容)
        function openPermissionsModal(type, name, id) {
            const container = document.getElementById('permissions-modal-container');
            // 在实际应用中，这里会发起请求获取权限数据，然后渲染模态框
            // 为简化示例，我们直接加载 modal 的 HTML 结构
            fetch('permissions-modal.html') // 假设 modal 的 HTML 在单独文件
                .then(response => response.text())
                .then(html => {
                    container.innerHTML = html;
                    // 更新模态框标题等信息
                    document.getElementById('modal-title-entity').textContent = name;
                    document.getElementById('modal-title-type').textContent = (type === 'user' ? '用户' : '部门');
                    // 显示模态框 (需要配合 CSS 控制显示隐藏)
                    document.getElementById('effective-permissions-modal').classList.remove('hidden');
                    document.getElementById('effective-permissions-modal').classList.add('fixed'); // Or use your modal showing mechanism
                })
                .catch(error => console.error('Error loading modal:', error));
        }

        function closePermissionsModal() {
             const modal = document.getElementById('effective-permissions-modal');
             if (modal) {
                 modal.classList.add('hidden');
                 modal.classList.remove('fixed');
                 document.getElementById('permissions-modal-container').innerHTML = ''; // 清空内容
             }
        }
    </script>

</body>
</html>
