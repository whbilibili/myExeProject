# 租户级功能权限体系

## 第一部分：我们为何需要一套新体系？ (Why Change?)

### 1.1 现状

*   **我们做对了什么**：已成功构建了一套以"空间"为维度的RBAC数据权限体系。
*   **核心矛盾**：现有的"数据权限"体系，无法解决"为特定的人解锁特定产品能力"的问题。
*   **结论**：我们必须在现有体系之上，引入一套全新的、更高维度的功能权限体系。

## 第二部分：核心理念 - 分离"功能"与"数据"权限 (The Core Idea)

为了解决这个矛盾，我们必须引入并清晰地区分两种权限，这也是业界顶尖SaaS产品的标准设计思想。

*   **数据权限 (管资源)**: 回答"用户能对哪个数据做什么操作？"
*   **功能权限 (管能力)**: 回答"用户有没有资格使用某个产品功能？"

### 一个比喻：健身房会员卡模型

把我们的产品想象成一家高端健身房：

*   **功能权限** 就像你的 **会员卡等级 (普通卡 vs. VIP卡)**。它决定了你是否有资格进入"恒温泳池"、"私教区"这些高级功能区域。
*   **数据权限** 就像你的 **储物柜钥匙**。它决定了你能打开8号还是9号具体的数据柜子。

**核心逻辑**：只有先刷了VIP卡（功能权限校验通过），你才能用你的钥匙去开柜子（数据权限校验）。一个拿着8号柜钥匙的普通卡会员，依然进不了VIP才能进的游泳池。

## 第三部分：竞品调研 - 我们的方向与行业一致

调研了Figma, Notion, GitHub，目前的方向和是一致的。

**核心发现**：所有平台都明确地分离了功能权限和数据权限，并且功能权限与商业模式 (订阅计划) 强绑定。

| 平台 | 功能权限体现 | 数据权限体现 | 对我们的启示 |
| :--- | :--- | :--- | :--- |
| **GitHub** | 订阅计划 (Team/Enterprise) 解锁高级功能 (如 Advanced Security)； 按席位(Seat) 分配 Copilot 使用权。 | 在仓库(Repository)级别为用户分配 Read, Write, Admin 等角色。 | "计划+席位"的混合功能授权模式，与数据权限完全分离，是业界最成熟、最灵活的实践。 |
| **Figma** | 通过付费席位(Seat) (如 Full, Dev) 来售卖不同的产品能力包，如设计编辑能力、开发者模式能力。 | 在文件(File)级别为用户分配 Viewer, Editor 角色。 | 将产品功能模块化并直接与席位挂钩，商业化意图明确，但可能增加协作摩擦。 |
| **Notion** | 订阅计划 (Plus/Business) 解锁高级管理能力，如权限群组、私密团队空间。 | 在页面(Page)级别为用户分配 Full access, Can edit 等角色。 | 通过协作规模化带来的"权限混沌"来驱动客户为"更强的管理能力"付费。 |

## 第四部分：我们的产品设计方案 (The Solution)

### 4.1 具体功能点设计

**A. 平台管理后台 (面向我们自己)**

*   **功能**："全局功能清单"管理。
*   **目的**：由平台管理员定义出所有可以被授权的高级功能（例如：AI报告、高级API、SSO配置），形成标准化的"功能资源池"。

**B. 租户管理后台 (面向租户管理员 - 方案核心)**

在租户后台（企业设置）新增 "功能与授权" 管理模块。

*   **主界面：功能列表**
    *   页面以一个功能列表的形式呈现，每一行是一个高级功能（例如"AI批量分析报告"），并简要说明该功能的作用。
*   **配置流程**：
    1.  管理员在功能列表中找到想配置的功能，点击右侧的 "配置权限" 按钮。
    2.  系统弹出一个配置窗口，提供三个授权维度：
        *   **全体成员**：一个总开关，可一键为租户内所有人生效/关闭此功能。
        *   **按部门/角色 (V2.0)**：一个下拉选择器，可以选择一个或多个部门/角色，为其批量开通。
        *   **按指定成员 (V1.0)**：一个成员搜索框，可以精确地搜索并添加/移除单个或多个成员对此功能的使用权。
    3.  点击"保存"，权限即时生效。
*   **价值**：这个"以功能为中心"的界面设计，完全符合管理直觉，逻辑清晰，操作高效，能轻松应对复杂的授权场景。

**C. 前端用户体验 (面向最终用户)**

*   **UI动态适配 (无感知授权)**:
    *   用户的界面上，只会出现他被授权使用的功能入口和按钮。没有权限的功能，用户根本看不到，提供了最简洁、无干扰的体验。
*   **功能引导与升级提示 (有感知引导)**:
    *   在一些非核心区域，可以适度展示未授权的高级功能，并标记为"企业版专享"或"联系管理员开通"。
*   **价值**：这样做既能激发用户的潜在需求，又能为未来的向上销售（Up-sell）创造机会，形成内部的增长动力。

## 第五部分：实施路线图与资源评估 (The Roadmap)

我们建议分阶段实施，小步快跑，快速验证。

### 第一阶段 (MVP - 验证核心价值)

*   **目标**：快速上线核心授权框架，满足核心需求。
*   **核心任务**：
    *   **后端**：完成"全局功能清单"和核心授权模型的开发。
    *   **后台**：实现"以功能为中心"的授权配置界面，并支持最核心的"按指定成员"进行授权。
    *   **前端**：选取1-2个核心高级功能，完成前端UI的动态适配。

### 第二阶段 (迭代完善 - 提升管理效率)

*   **目标**：提升批量管理效率，完善用户体验。
*   **核心任务**：
    *   **后台**：增加"按部门/角色"和"全体成员"的批量授权功能。
    *   **前端**：全面铺开所有高级功能的前端适配，并植入"升级提示"引导。
