<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æˆ‘çš„ç”¨é‡ - ç”¨æˆ·ä»ªè¡¨ç›˜</title>
  
  <!-- Element Plus CSS -->
  <link rel="stylesheet" href="https://unpkg.com/element-plus@2.4.4/dist/index.css">
  
  <!-- è‡ªå®šä¹‰é£ä¹¦è®¾è®¡ç³»ç»Ÿ -->
  <link rel="stylesheet" href="./assets/css/feishu-design.css">
  
  <style>
    /* é…é¢å¡ç‰‡æ ·å¼ */
    .quota-section {
      background: var(--bg-1);
      border-radius: var(--radius-large);
      padding: var(--spacing-6);
      box-shadow: var(--shadow-1);
      margin-bottom: var(--spacing-6);
    }
    
    .quota-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--spacing-5);
    }
    
    .quota-title {
      font-size: 14px;  /* OpenAIé£æ ¼ - æœ€å¤§å­—ä½“ */
      font-weight: var(--font-weight-semibold);
      color: var(--text-1);
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
    }
    
    .quota-title::before {
      content: '';
      width: 4px;
      height: 20px;
      background-color: var(--primary-color);
      border-radius: var(--radius-medium);
    }
    
    .quota-subtitle {
      font-size: 12px;  /* OpenAIé£æ ¼ - è¾…åŠ©æ–‡å­— */
      color: var(--text-3);
      margin-top: var(--spacing-1);
    }
    
    .quota-info {
      background: var(--fill-1);
      border-radius: var(--radius-medium);
      padding: var(--spacing-4);
      margin-bottom: var(--spacing-4);
      font-size: 12px;  /* OpenAIé£æ ¼ - æç¤ºæ–‡å­— */
      color: var(--text-3);
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
    }
    
    .quota-info .tooltip-icon {
      margin-left: auto;
    }
    
    .quota-card {
      background: var(--bg-1);
      border: 1px solid var(--border-2);
      border-radius: var(--radius-large);
      padding: var(--spacing-5);
      transition: all var(--duration-base) var(--ease-in-out);
    }
    
    .quota-card:hover {
      border-color: var(--primary-lighter);
      box-shadow: var(--shadow-1);
    }
    
    .quota-card-header {
      display: flex;
      align-items: center;
      gap: var(--spacing-3);
      margin-bottom: var(--spacing-4);
    }
    
    .quota-icon {
      width: 40px;  /* OpenAIé£æ ¼ - æ›´ç´§å‡‘çš„å›¾æ ‡ */
      height: 40px;
      border-radius: var(--radius-large);
      background: var(--primary-lightest);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;  /* OpenAIé£æ ¼ - ç¼©å°å›¾æ ‡ */
      color: var(--primary-color);
    }
    
    .quota-card-title {
      font-size: 13px;  /* OpenAIé£æ ¼ - å¡ç‰‡æ ‡é¢˜ */
      font-weight: var(--font-weight-semibold);
      color: var(--text-1);
    }
    
    .quota-progress {
      margin-bottom: var(--spacing-4);
    }
    
    .quota-info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 13px;  /* OpenAIé£æ ¼ - æ•°æ®è¡Œæ–‡å­— */
      color: var(--text-2);
    }
    
    .quota-usage {
      font-weight: var(--font-weight-semibold);
      color: var(--primary-color);
    }
    
    .quota-total {
      color: var(--text-3);
    }
    
    /* ç§Ÿæˆ·é€‰æ‹©å™¨æ ·å¼ */
    .tenant-selector {
      background: var(--bg-1);
      border-radius: var(--radius-large);
      padding: var(--spacing-5);
      box-shadow: var(--shadow-1);
      margin-bottom: var(--spacing-6);
    }
    
    .tenant-selector-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--spacing-4);
    }
    
    .tenant-selector-title {
      font-size: var(--font-size-16);
      font-weight: var(--font-weight-semibold);
      color: var(--text-1);
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
    }
    
    .tenant-selector-title::before {
      content: '';
      width: 4px;
      height: 20px;
      background-color: var(--primary-color);
      border-radius: var(--radius-medium);
    }
    
    /* æ ‡ç­¾é¡µå®¹å™¨ */
    .tabs-wrapper {
      background: var(--bg-1);
      border-radius: var(--radius-large);
      box-shadow: var(--shadow-1);
      overflow: hidden;
    }
    
    .tab-content-iframe {
      width: 100%;
      min-height: 800px;
      border: none;
      display: block;
      background: var(--bg-2);
    }
    
    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 768px) {
      .quota-card-header {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-3);
      }
      
      .quota-info-row {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-2);
      }
    }
  </style>
</head>
<body>
  <div id="app" class="page-wrapper">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="navbar">
      <div class="navbar-container">
        <div class="navbar-left">
          <div class="navbar-title">
            <el-icon :size="24" color="#3370FF">
              <el-icon-data-analysis />
            </el-icon>
            <span>æˆ‘çš„ç”¨é‡</span>
          </div>
        </div>
        <div class="navbar-right">
          <el-tag type="info" size="small">ç”¨æˆ·ä»ªè¡¨ç›˜ V1.0</el-tag>
        </div>
      </div>
    </div>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-container fade-in">
      <!-- é…é¢å±•ç¤ºåŒºåŸŸ -->
      <div class="quota-section">
        <div class="quota-header">
          <div>
            <div class="quota-title">æˆ‘çš„é…é¢</div>
            <div class="quota-subtitle">ä¸ªäººèµ„æºé…é¢ä¸ä½¿ç”¨è¿›åº¦</div>
          </div>
        </div>
        
        <div class="quota-info">
          <el-icon><el-icon-info-filled /></el-icon>
          <span>æ­¤åŒºåŸŸæ˜¾ç¤ºç§Ÿæˆ·ç®¡ç†å‘˜ä¸ºæ‚¨é…ç½®çš„ä¸ªäººèµ„æºé…é¢ã€‚ä»…æ˜¾ç¤ºæœ‰é™åˆ¶çš„èµ„æºï¼Œæ— é™åˆ¶èµ„æºæ˜¾ç¤ºä¸º"æ— é™åˆ¶"ï¼Œå…±äº«æˆ–ä¸å—é™åˆ¶çš„èµ„æºä¸åœ¨æ­¤å¤„æ˜¾ç¤ºã€‚å¦‚éœ€è°ƒæ•´é…é¢ï¼Œè¯·è”ç³»ç§Ÿæˆ·ç®¡ç†å‘˜ã€‚</span>
        </div>
        
        <!-- é…é¢å¡ç‰‡ -->
        <div class="quota-card">
          <div class="quota-card-header">
            <div class="quota-icon">ğŸ’»</div>
            <div class="quota-card-title">äº‘ç”µè„‘è®¾å¤‡ä½¿ç”¨æ—¶é•¿</div>
          </div>
          <div class="quota-progress">
            <el-progress 
              :percentage="quotaData.usagePercent" 
              :stroke-width="12"
              :color="quotaData.usagePercent > 80 ? '#F53F3F' : '#3370FF'"
            />
          </div>
          <div class="quota-info-row">
            <span class="quota-usage">å·²ä½¿ç”¨: {{ quotaData.used }}å°æ—¶</span>
            <span class="quota-total">æ€»é…é¢: {{ quotaData.total === -1 ? 'æ— é™åˆ¶' : quotaData.total + 'å°æ—¶' }}</span>
          </div>
        </div>
      </div>
      
      <!-- æ ‡ç­¾é¡µåŒºåŸŸ -->
      <div class="tabs-wrapper">
        <el-tabs v-model="activeTab" type="card">
          <el-tab-pane label="æ•°æ®æ€»è§ˆ" name="overview">
            <template #label>
              <span style="display: flex; align-items: center; gap: 6px;">
                <el-icon><el-icon-data-analysis /></el-icon>
                æ•°æ®æ€»è§ˆ
                <el-tooltip content="æœ¬é¡µæ‰€æœ‰æ•°æ®å‡å—é¡µé¢é¡¶éƒ¨çš„'æ—¶é—´èŒƒå›´'å’Œ'ç§Ÿæˆ·'ç­›é€‰å™¨å½±å“ã€‚" placement="top">
                  <i class="tooltip-icon">i</i>
                </el-tooltip>
              </span>
            </template>
            <iframe
              v-if="activeTab === 'overview'"
              :src="`pages/overview.html?userId=${userId}`"
              class="tab-content-iframe"
              frameborder="0"
            ></iframe>
          </el-tab-pane>
          
          <el-tab-pane label="èµ„æºæ¶ˆè€—æ˜ç»†" name="consumption">
            <template #label>
              <span style="display: flex; align-items: center; gap: 6px;">
                <el-icon><el-icon-coin /></el-icon>
                èµ„æºæ¶ˆè€—æ˜ç»†
                <el-tooltip content="æ­¤åŒºåŸŸåˆ—å‡ºè¯¥ç§Ÿæˆ·ä¸‹æ¯ç¬”èµ„æºå˜åŠ¨çš„è¯¦ç»†ä¿¡æ¯ï¼ŒæŒ‰æ—¶é—´å€’åºæ’åˆ—ï¼Œæ˜¯è®¡ç®—'æˆ‘çš„é…é¢'ä½¿ç”¨é‡çš„ä¾æ®ã€‚å¯é€šè¿‡ç­›é€‰å™¨è¿›è¡Œç²¾ç¡®è¿½è¸ªã€‚" placement="top">
                  <i class="tooltip-icon">i</i>
                </el-tooltip>
              </span>
            </template>
            <iframe
              v-if="activeTab === 'consumption'"
              :src="`pages/consumption.html?userId=${userId}`"
              class="tab-content-iframe"
              frameborder="0"
            ></iframe>
          </el-tab-pane>
          
          <el-tab-pane label="èµ„äº§æ˜ç»†" name="assets">
            <template #label>
              <span style="display: flex; align-items: center; gap: 6px;">
                <el-icon><el-icon-box /></el-icon>
                èµ„äº§æ˜ç»†
                <el-tooltip content="æœ¬é¡µç­¾å†…æ‰€æœ‰ç»Ÿè®¡æ•°æ®å‡éµå¾ªé¡µé¢é¡¶éƒ¨çš„å…¨å±€'æ—¶é—´èŒƒå›´'å’Œ'ç§Ÿæˆ·'ç­›é€‰æ¡ä»¶ã€‚" placement="top">
                  <i class="tooltip-icon">i</i>
                </el-tooltip>
              </span>
            </template>
            <iframe
              v-if="activeTab === 'assets'"
              :src="`pages/assets.html?userId=${userId}`"
              class="tab-content-iframe"
              frameborder="0"
            ></iframe>
          </el-tab-pane>
        </el-tabs>
      </div>
    </div>
  </div>
  
  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3.3.11/dist/vue.global.js"></script>
  <!-- Element Plus -->
  <script src="https://unpkg.com/element-plus@2.4.4/dist/index.full.js"></script>
  <!-- Element Plus Icons -->
  <script src="https://unpkg.com/@element-plus/icons-vue@2.3.1/dist/index.iife.min.js"></script>
  
  <!-- å·¥å…·å‡½æ•° -->
  <script src="./assets/js/utils.js"></script>
  <!-- Mockæ•°æ® -->
  <script src="./assets/js/mock-data.js"></script>
  
  <script>
    const { createApp, ref, computed, onMounted } = Vue;
    
    const app = createApp({
      setup() {
        // å“åº”å¼æ•°æ®
        const userId = ref('');
        const activeTab = ref('overview');
        const quotaData = ref({
          used: 0,
          total: -1, // -1è¡¨ç¤ºæ— é™åˆ¶
          usagePercent: 0
        });
        
        // åˆå§‹åŒ–ç”¨æˆ·ID
        const initUserId = () => {
          // å¦‚æœæ²¡æœ‰userIdï¼Œè·å–ç¬¬ä¸€ä¸ªç”¨æˆ·
          if (!userId.value) {
            try {
              const allUsers = MockData.getUsers({ page: 1, pageSize: 1 });
              if (allUsers.list && allUsers.list.length > 0) {
                userId.value = allUsers.list[0].id;
                loadQuotaData();
              } else {
                ElementPlus.ElMessage.error('æ— æ³•åŠ è½½ç”¨æˆ·æ•°æ®ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
              }
            } catch (error) {
              console.error('Error loading users:', error);
              ElementPlus.ElMessage.error('åŠ è½½ç”¨æˆ·æ•°æ®æ—¶å‡ºé”™');
            }
          }
        };
        
        // åŠ è½½é…é¢æ•°æ®
        const loadQuotaData = () => {
          // æ¨¡æ‹Ÿé…é¢æ•°æ®
          const used = Math.floor(Math.random() * 200); // 0-200å°æ—¶
          const total = -1; // æ— é™åˆ¶
          const usagePercent = total === -1 ? 0 : Math.min((used / total) * 100, 100);
          
          quotaData.value = {
            used,
            total,
            usagePercent
          };
        };
        
        // åˆå§‹åŒ–
        onMounted(() => {
          initUserId();
        });
        
        return {
          userId,
          activeTab,
          quotaData
        };
      }
    });
    
    // æ³¨å†ŒElement Pluså›¾æ ‡
    for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
      app.component(`ElIcon${key}`, component);
    }
    
    app.use(ElementPlus).mount('#app');
  </script>
</body>
</html>
