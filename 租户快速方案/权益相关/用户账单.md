【设计中】用户账单

1. 功能概述

1.1. 目标

本功能旨在为平台用户提供一个集中化、高透明度的资源使用查询中心。其核心目标在于，使用户得以精确掌握在不同租户上下文环境下的资源消耗、释放详情及各项资源的配额状态。通过提供清晰、可追溯的数据，本功能致力于培养用户的成本意识，引导其进行合理的资源规划与使用，这不仅有助于用户自身的项目管理，亦能为租户管理员的成本控制策略提供数据支持，并最终提升平台整体资源的分配与使用效率。

1.2. 入口

用户通过以下标准化路径访问本功能：导航至平台左下角的用户头像，点击以展开浮层菜单，选择“用户设置”进入详情页面，并在个人设置的功能分区下，点击“我的账单”标签页。该入口的设计确保了功能的可发现性，并将其置于用户个人化管理的逻辑范畴之内。

2. 页面布局与信息架构

为实现最优的信息架构与操作效率，页面采用集成式顶栏结合上下布局的模式。所有信息从上到下线性排列，逻辑清晰，符合主流用户习惯，确保了核心信息的易读性和操作的流畅性。

全局标题栏 (固定): 作为页面的最高层级控制器，部署了全局性的租户选择器，其选择将决定页面所有后续内容的上下文。

我的配额 (卡片化区域): 紧随全局标题栏下方，将各项配额以“卡片”的形式横向或网格化排列，作为当前配额状态的概览仪表盘。

账单流水 (页面主体): 位于“我的配额”区域下方，是用户进行数据探索与分析的主要工作区，包含次级筛选区及数据列表。

2.1. 用户引导设计

为帮助用户理解多租户概念，页面集成了多层次的引导信息：

页面级提示横幅: 在全局标题栏下方，应有一个可关闭的提示横幅 (Alert Banner)，用于首次或全局性地解释页面核心逻辑。

建议文案: “提示：此页面展示您在特定租户（或称工作空间）下的资源用量。请在上方选择租户以查看对应的配额与账单。”

关键控件微说明: 在核心控件旁提供即时帮助，解答用户的潜在疑惑。

3. 功能模块详细设计

3.1. 全局标题栏

此模块位于页面顶部并固定，作为整个页面的最高层级、唯一的上下文控制器，其设计旨在提供一个稳定且明确的全局操作起点。

核心控件: 租户选择器，以标准下拉菜单形式呈现，支持搜索功能，单选。

概念解释: 控件标签旁应附有一个信息图标 ( i )。当用户鼠标悬浮或点击该图标时，系统应展示一个工具提示（Tooltip），用以解释多租户的概念。

Tooltip文案建议:

标题: “什么是租户？”

内容: “租户可以理解为您所在的一个独立工作空间或团队。您在不同租户下的资源配额和消耗记录是完全隔离的。例如，您在‘公司A’租户下创建的智能体，其消耗只会计入‘公司A’的账单。”

交互规范:

默认选择: 页面初始化加载时，系统应基于用户活动记录，默认选中其最近一次处于活跃状态的租户。

上下文切换: 用户的租户切换操作将触发下方的“我的配额”与“账单流水”模块的数据同步刷新。在数据请求及渲染过程中，系统必须提供明确的、非阻塞式的加载状态指示（例如，在受影响的模块上显示加载动画），以管理用户等待预期。

3.2. 我的配额 (My Quotas)

此模块定位为用户的实时状态仪表盘，位于全局标题栏下方，其展示内容完全由全局标题栏的租户选择所驱动，旨在提供即时、一目了然的配额状态概览。

核心逻辑:

展示原则: 本模块是用户个人专属配额的仪表盘。仅当一项资源在设计上支持按“人头”进行精细化分配时，才应在此处为其展示配额卡片。

应展示: 对于可被管理员设置为具体数值或“无限制”的个人配额（如“云电脑设备时长”），应始终显示卡片以明确告知用户其个人配置。

不应展示: 对于租户内所有成员共享、或从设计上就不存在个人限制概念的资源（如“新建工作流”的权限），则不应显示卡片。其“不出现”即隐喻了该项不受个人配额追踪。

被动式展示: 本模块的功能定位为被动式信息展示，不包含任何控制逻辑。

实时性: 模块不设时间筛选功能，其数据必须始终反映当前的实时配额状态。

信息架构:

模块标题: “我的配额”。

内容结构: 以卡片化或网格化形式呈现，每一张卡片代表一种受限资源。

资源名称与周期: 需明确标示资源名称及其重置周期，例如：“消耗积分 (每月)”、“API调用次数 (每日)”、“可创建空间数 (总量)”。

可视化进度条: 用于直观展示已用配额与总配额的比例。鼠标悬浮于进度条上时，应有工具提示（Tooltip）显示精确的百分比数值。

精确数值: 以已用量 / 总量 单位的格式呈现，例如 850 / 2000 点。

无限制状态: 对于未设置配额上限的资源，其卡片样式应有特殊处理：

移除进度条和“已用量 / 总量”的数值显示。

在卡片主体位置明确显示“无限制”文本标签，以提供清晰、无歧义的状态说明。

界面与状态规范:

加载状态: 在执行租户切换时，此模块应展示骨架屏（Skeleton Screen）或等效的加载动画，以提供平滑的过渡体验。

空状态: 若用户在当前选定的租户下不存在任何配额限制，模块内应显示相应的提示文本，例如：“您在此租户下暂无配额限制”。

告警状态: 当配额使用率达到预设阈值（建议为80%）时，进度条应转为黄色（#FBBF24）；超过100%时则转为红色（#F87171），以提供有效的视觉警示。

多配额处理: 为应对配额项过多的极端情况并保持界面整洁，采用折叠模式。

默认状态: 默认仅展示一行（如4个）最重要的配额卡片。

展开/收起: 在首行卡片下方提供“显示更多”按钮。点击后，区域平滑展开以网格形式显示所有配额卡片，按钮文案变为“收起”。再次点击则收起。

3.3. 账单流水 (Bill Flow)

此模块位于“我的配额”下方，作为用户的历史事务记录档案，以表格形式详尽记录所有资源变动事件，是进行深度追溯与审计的核心区域。

筛选区设计:

数据上下文: 本模块所展示的数据集，其归属范围严格限定于全局标题栏当前选定的租户。

时间范围筛选: 提供精确到日的范围筛选功能。系统应预置“今日”、“最近7日”、“本月”、“上月”等快捷选项，并支持用户自定义日期范围。为优化性能，对自定义日期范围的查询请求应采用去抖（Debounce）策略。

资源类型筛选: 提供多项选择功能，以复选框列表或带搜索功能的多选下拉菜单形式呈现。选项应覆盖所有可计量的资源类型。

表格列定义与规范:

列名 (Column Name)

描述 (Description)

示例 (Example)

日期 (Date)

消耗发生的日期，可以精确到天。

2025-08-08 18:00:00，表格默认按此列降序排列

资源类型 (Resource Type)

消耗的具体资源种类。

智能体、工作流、Token、云电脑设备时长等

行为 (Feature/Operation)

用户通过什么功能或操作产生的消耗。

新建智能体、运行工作流调用云电脑设备等

变动类型 (Change Type)

明确记录该条流水的性质是消耗还是返还。

消耗、返还

用量 (Usage Amount)

消耗或返还的绝对数量。

个、分钟、输入Token：xxxx、输出Token：xxxx

消耗积分 (Points Used)

调用对应资源消耗的积分。

xxx点（时长不足时抵扣积分、Token消耗积分）

计费方 (Billed To)

这笔消耗最终由哪个租户承担。

租户A

示例数据 (Sample Data):
以下为账单流水的示例数据，用于展示不同场景下的记录格式。

日期 (Date)

资源类型

行为

变动类型

用量

消耗积分

计费方

2025-08-08 10:30:00

智能体

新建智能体

消耗

1个

-

租户A

2025-08-07 15:00:12

云电脑设备时长

手动调用云电脑设备

消耗

30分钟

-

租户A

2025-08-07 14:00:00

云电脑设备时长

手动调用云电脑设备 - 积分抵扣时长

消耗

10分钟

-100点

租户A

2025-08-07 09:05:45

Token

调用 GPT 4o

消耗

输入: 1024, 输出: 512

-50点

租户A

2025-08-06 18:00:00

智能体

删除智能体

返还

1个

-

租户A

2025-08-05 11:20:30

手机设备时长

运行工作流调用手机设备

消耗

15分钟

-

租户B

2025-08-05 11:35:30

手机设备时长

...积分抵扣时长

消耗

5分钟

-50点

租户B

核心逻辑与状态:

消耗逻辑: 积分是核心消耗单位，主要用于抵扣Token、云电脑设备时长、手机设备时长。设备时长的消耗优先使用其专属配额，仅在配额不足且用户同意的情况下，才通过消耗积分进行抵扣。行为列应明确区分这两种消耗方式。

双向记录: 系统必须对消耗与返还两种方向的事务进行同等记录，以构建一个完整的、可审计的资源变动闭环。通过新增的变动类型列明确标识流水的性质，而用量列则只记录变动的绝对数量。

数据来源: 本流水记录是计算“我的配额”模块中“已消耗量”的唯一且权威的数据源。两者之间的数据一致性必须得到严格保证。

分页机制: 考虑到数据量可能较大，表格必须实现基于后端的服务器分页，默认每页展示10条记录。

空状态: 在当前筛选条件下若无任何数据返回，表格区域应展示带有引导信息的空状态提示。

建议文案: 标题为“暂无用量记录”，附带说明“当您在‘[当前租户名]’租户下开始使用平台功能（如运行工作流、调用API等），相关的资源消耗明细将会在这里实时记录。”