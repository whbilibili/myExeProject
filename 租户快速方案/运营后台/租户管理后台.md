# 后台 - 租户管理模块最终方案 (V4.1 - Implementation Ready)

## A. 核心模块一：租户列表 (Tenant List)

**功能描述:** 平台所有租户的全局指挥中心，提供高效的检索、状态洞察和快速操作入口。

### 1. 列表字段定义

| 列表字段 | 字段说明与统计口径 |
| :--- | :--- |
| **租户ID** | 系统生成，平台唯一ID。可点击一键复制。 |
| **租户名称** | `租户Logo` + `租户名称`。点击进入详情页。 |
| **创建人** | 创建该租户的平台用户（头像+名称）。 |
| **健康度** | **综合评分 (0-100)**，以"颜色+分数"展示。<br>• **80+ (绿色):** 健康<br>• **60-79 (蓝色):** 正常<br>• **40-59 (黄色):** 关注<br>• **<40 (红色):** 危险 |
| **所有者** | 该租户的当前负责人（头像+名称）。 |
| **成员/上限** | `当前成员数` / `套餐成员数上限`。例如：`98/100`。超过80%时高亮。 |
| **订阅套餐** | 当前订阅套餐及状态。例如：`企业版 (试用中)`、`团队版 (25天后到期)`。 |
| **创建时间** | `YYYY-MM-DD HH:mm:ss`。 |
| **状态** | **租户的业务身份**。<br>• **正常:** 已付费或在免费套餐内。<br>• **禁用:** 被运营手动禁用。<br>• **套餐到期:** 付费套餐已过有效期，进入功能限制的宽限期。<br>• **已流失:** 宽限期结束后仍未续费，租户被归档。 |
| **操作** | `进入详情`、`禁用/启用`、`修改积分`。 |

### 2. 健康度指标与算法完整说明

健康度是一个量化租户业务健康状况的核心指标，旨在为运营提供一个快速、直观的判断依据。V1版本的算法将聚焦于最核心且最易于统计的两个维度：**成员活跃**和**功能采纳**。

#### 2.1. 健康度最终得分

*   **UI展示:** 在租户列表和详情页，以“颜色+分数”的形式展示。
    *   **80-100 (绿色):** 健康
    *   **60-79 (蓝色):** 正常
    *   **40-59 (黄色):** 关注
    *   **0-39 (红色):** 危险
*   **计算公式:**
    **`HealthScore = (成员活跃率分数 * 60%) + (核心功能采纳度分数 * 40%)`**

#### 2.2. 分项指标一：成员活跃率分数 (权重 60%)

*   **目标:** 衡量产品在租户内部的**渗透广度**。回答“这个租户有多少比例的人在真正使用我们的产品？”
*   **计算公式:**
    **`分数 = (周期内活跃成员数 / 租户总成员数) * 100`**
*   **指标定义:**
    *   `周期内活跃成员数`: 在选定时间周期内（默认为“最近30天”），执行过至少一次“有效行为”的**去重**成员数量。
    *   `有效行为`: 明确定义为 **用户登录、任意资产（智能体/工作流）的执行、任意资产的创建或修改**。
    *   `租户总成员数`: 该租户下状态为“正常”的成员总数。
*   **数据示例:**
    *   某租户总成员数为50人。
    *   在最近30天，有35人登录过或运行过智能体。
    *   成员活跃率分数 = `(35 / 50) * 100 = 70`。

#### 2.3. 分项指标二：核心功能采纳度分数 (权重 40%)

*   **目标:** 衡量产品在租户内部的**使用深度**。回答“这个租户是否在探索并使用我们平台的核心价值功能？”
*   **计算公式:**
    **`分数 = (租户已使用的核心功能数 / 平台定义的核心功能总数) * 100`**
*   **指标定义:**
    *   `平台定义的核心功能总数`: 由平台方在后台预先定义的一份功能清单，这份清单代表了产品的核心价值。**这份清单应稳定，不轻易变动。**
        *   **示例清单:** `[智能体, 工作流, 知识库, 云电脑, 云手机]`。则核心功能总数为 **5**。
    *   `租户已使用的核心功能数`: 在选定时间周期内，统计该租户在上述清单中，有多少个功能产生了至少一次使用记录。
*   **数据示例:**
    *   平台核心功能总数为5。
    *   某租户在最近30天，调用过“智能体”、运行过“工作流”，但从未使用过知识库和云设备。
    *   租户已使用的核心功能数 = **2**。
    *   核心功能采纳度分数 = `(2 / 5) * 100 = 40`。

#### 2.4. 最终得分计算示例

*   基于上述例子：
*   **`HealthScore = (70 * 60%) + (40 * 40%) = 42 + 16 = 58`**
*   该租户的最终健康度为 **58**，在UI上将展示为 **`58 (黄色 - 关注)`**。

### 3. 搜索与筛选

*   **模糊搜索:** 支持按 `租户名称`、`租户ID`、`所有者名称/ID` 进行搜索。
*   **筛选器:**
    *   **状态:** `[正常]`, `[禁用]`, `[套餐到期]`, `[已流失]`。
    *   **健康度:** `[危险]`, `[关注]`, `[正常]`, `[健康]`。
    *   **订阅套餐:** (多选) `[免费版]`, `[团队版]`, `[企业版]`...
    *   **所有者:** (支持远程搜索的多选下拉框)。

---

## B. 核心模块二：租户详情页

### 1. 页面顶部设计：信息区与操作区

#### 1.1. 顶部信息区 (只读)

*   **布局:** 一个简洁、多行、信息分组的卡片式布局。
*   **第一行 (核心身份标识):**
    *   **租户Logo:** 48x48px的图片。
    *   **租户名称:** 加粗、大号字体。
    *   **租户ID:** 位于租户名称下方，字体略小，灰色。旁边附带一个 **[复制]** 图标，点击后提示“已复制到剪贴板”。
*   **第二行 (核心状态指标):**
    *   **所有者:** `标签(所有者):` `[头像]` `[用户名称]`。用户名称为蓝色链接，点击可跳转至该用户的详情页。
    *   **当前套餐:** `标签(当前套餐):` `企业版 (试用中)`。括号内的状态需要根据实际情况动态高亮，例如“试用中”为橙色，“已到期”为红色。
    *   **健康度:** `标签(健康度):` `58 (关注)`。分数和文字根据健康度算法结果动态展示颜色。
    *   **成员席位:** `标签(成员席位):` `98 / 100`。当使用量超过95%时，整个数值变为红色预警。

#### 1.2. 核心操作按钮区

*   **位置:** 页面右上角，与顶部信息区平行。
*   **按钮1: `启用 / 禁用`**
    *   **按钮文案:** 根据租户当前状态动态显示。若租户为“正常”，按钮显示为 `[禁用]`；若租户为“禁用”，按钮显示为 `[启用]`。
    *   **交互:** 点击后，触发**确认模态框**。
    *   **模态框内容 (以禁用为例):**
        *   **标题:** `确认禁用租户 [租户名称]？`
        *   **警告信息:** “禁用后，该租户下的所有成员将无法登录和使用平台资源。此操作可在之后重新启用。为防止误操作，请输入 `禁用` 以确认。”
        *   **确认输入框:** 一个文本输入框。
        *   **操作按钮:** `[确认禁用]` (默认禁用，在输入框内容完全匹配“禁用”后启用)、 `[取消]`。

*   **按钮2: `修改积分`**
    *   **交互:** 点击后，触发**修改积分模态框**。
    *   **模态框内容:**
        *   **标题:** `修改租户 [租户名称] 的积分`
        *   **只读信息:** `当前积分余额: 1,200,000`。
        *   **调整类型 (单选框):** `(•) 追加` `( ) 覆盖`。默认为“追加”。
        *   **调整数量 (数字输入框):** 允许输入正负数。
        *   **调整原因 (下拉框，必选):** `[售前测试]`, `[客户补偿]`, `[市场活动赠送]`, `[技术故障补偿]`, `[付费增购(线下)]`。
        *   **操作按钮:** `[确认修改]`, `[取消]`。

*   **按钮3: `变更套餐`**
    *   **交互:** 点击后，触发**变更套餐模态框**。
    *   **模态框内容:**
        *   **标题:** `为 [租户名称] 变更套餐`
        *   **只读信息:** `当前套餐: 企业版`、`当前周期: 2025-01-01 至 2025-12-31`。
        *   **新套餐 (下拉框):** 列出所有可选的套餐计划。
        *   **生效时间 (单选框):** `(•) 立即生效` `( ) 在当前周期结束后生效`。
        *   **（可选）价格覆盖 (数字输入框):** 允许运营为此次变更输入一个自定义的合同价格。
        *   **操作按钮:** `[确认变更]`, `[取消]`。

*   **按钮4: `发送通知`**
    *   **交互:** 点击后，触发**发送通知模态框**。
    *   **模态框内容:**
        *   **标题:** `向租户 [租户名称] 发送通知`
        *   **发送至 (复选框):** `[ ] 所有者` `[ ] 所有管理员` `[ ] 所有成员`。可多选，默认勾选“所有者”。
        *   **发送渠道 (复选框):** `[ ] 站内信` `[ ] 邮件`。
        *   **标题 (文本输入框):**
        *   **内容 (富文本编辑器或多行文本域):**
        *   **操作按钮:** `[立即发送]`, `[取消]`。

### 2. 页面标签页导航

1.  `数据总览 (Dashboard)`
2.  `时间线 (Timeline)` **(新增)**
3.  `消费分析 (Consumption Analysis)`
4.  `资产分析 (Asset Analysis)`
5.  `成员与权限 (Members & Permissions)`
6.  `订阅与计费 (Subscription & Billing)`
7.  `租户设置 (Settings)`

### 3. 标签页详情


#### **3.1. 数据总览 (Dashboard)**

**页面目标:** 作为运营人员的“驾驶舱”，此页面旨在通过高度浓缩的数据，在30秒内清晰地回答三个核心问题：1. 该租户的当前业务健康状况如何？ 2. 是否存在明确的风险或机会？ 3. 导致这些状况的核心原因是什么？

**全局筛选器:** 页面右上角提供一个时间范围选择器，选项包括 `最近7天`, `最近30天` (默认), `本月`, `上月`, 以及自定义日期范围。页面所有数据均受此筛选器影响。

---

##### **模块一：关键告警与建议模块**

**功能描述:** 在页面最顶部，通过最醒目的方式主动推送需要运营立即关注的风险和机会。

*   **UI:** 一个独立的、带背景色的卡片区域，可展示多条告警。
*   **触发逻辑:** 系统每日或每小时后台扫描所有租户，当满足预设规则时，生成告警并展示在此处，直至告警条件消失或被运营手动忽略。
*   **告警规则示例:**
    *   **[▲ 风险] 积分余额预警:** `IF (当前积分余额 / 近7日日均消耗) < 预设天数 (例如: 7天)`
    *   **[▲ 风险] 健康度急剧下降:** `IF (今日健康度 < 昨日健康度 - 15)`
    *   **[▲ 风险] 关键资产失败率过高:** `IF (某关键资产近24小时失败率 > 20%)`
    *   **[💡 机会] 成员席位即将满额:** `IF (当前成员数 / 套餐成员数上限 > 95%)`
    *   **[💡 机会] 试用期即将结束:** `IF (租户为试用状态 AND 剩余试用天数 <= 3)`

---

##### **模块二：核心指标 (KPI Cards)**

**功能描述:** 以四个关键绩效指标卡片的形式，量化租户在活跃度、产出、使用广度方面的核心表现。

| 指标名称 | 指标计算与定义 | 业务价值 |
| :--- | :--- | :--- |
| **成员活跃率 (Activation Rate)** | **`(周期内活跃成员数 / 总成员数) * 100`**<br>• `活跃成员`: 周期内至少有1次有效行为（登录、资产调用/创建）的去重用户。<br>• `总成员`: 状态为“正常”的成员总数。 | 衡量产品在租户内部的渗透广度。 |
| **核心资产产出 (Key Asset Output)** | **`SUM(关键智能体调用次数) + SUM(关键工作流成功运行次数)`**<br>• `关键资产`: 由系统自动标记（高采纳/高调用）+运营手动标记的资产。 | 衡量租户是否在使用平台最具价值的核心功能解决实际问题。 |
| **资产使用率 (Utilization Rate)** | **`(周期内被使用过的资产数 / 总资产数) * 100`**<br>• `被使用过的资产`: 周期内至少被调用/运行过1次的去重资产。 | 衡量租户资产的沉淀与活跃情况，识别“僵尸资产”。 |
| **总消耗积分 (Total Points Consumed)** | **`SUM(周期内所有消耗记录的积分)`**<br>• 包含Token、设备时长抵扣等所有消耗类型。 | 直观反映租户在周期内的消费体量。 |

*   **交互:** 每个KPI卡片下方都附有一个与上周期的对比百分比，例如 `↑ 15%` 或 `↓ 8%`。

---

##### **模块三：诊断图表**

**功能描述:** 通过三张核心图表，对KPI指标进行深度可视化分析，帮助运营定位问题根源。

**图表一: 活跃度诊断图 (Activity Diagnostics)**

*   **图表类型:** 组合图 (柱状图 + 双折线图)
*   **业务目标:** 分析租户整体活跃度的构成，判断活跃度变化是由核心成员驱动还是普通成员驱动。
*   **X轴:** **时间** (若范围 ≤ 30天，则按“天”聚合；若 > 30天，则按“周”聚合)。
*   **Y1轴 (左侧, 柱状图):** **总资产调用次数** (单位: 次)。
*   **Y2轴 (右侧, 折线图):** **活跃成员数** (单位: 人)。
*   **数据系列:**
    *   **柱状图:** 每日/周的资产（智能体+工作流）总调用次数。
    *   **折线图1 (主线):** 每日/周的**总活跃成员数**。
    *   **折线图2 (辅线):** 每日/周的**核心成员活跃数** (核心成员=所有者+管理员)。
*   **交互:** 鼠标悬浮在图表上任意一天/周，会显示一个Tooltip，包含当日/周的三个具体数值。

**图表二: 消费诊断图 (Consumption Diagnostics)**

*   **图表类型:** 可下钻的堆叠面积图
*   **业务目标:** 直观展示租户的消费趋势和主要成本构成，并能够快速归因到具体日期。
*   **X轴:** **时间** (聚合逻辑同上)。
*   **Y轴:** **消耗积分** (单位: 点)。
*   **数据系列 (堆叠):**
    *   `Token消耗`
    *   `云电脑时长抵扣`
    *   `云手机时长抵扣`
    *   `其他`
*   **交互:**
    *   **悬浮:** 鼠标悬浮在图表上任意一天/周，显示当日/周的总消耗及各分项消耗。
    *   **点击 (下钻):** 点击图表中任意一天/周的区域，下方会浮出一个小型详情卡片，内容为：“**[所选日期] 消费归因:**<br>• **Top 3 消费成员:** 张三 (1500点), 李四 (1200点), 王五 (800点)<br>• **Top 3 消费资产:** 销售分析Bot (2800点), 每日报告流 (1500点), ...”。

**图表三: 功能采用雷达图 (Feature Adoption Radar)**

*   **图表类型:** 雷达图
*   **业务目标:** 快速、可视化地评估租户在平台几个核心功能上的使用广度和深度，一眼识别其业务偏好和待拓展的功能领域。
*   **雷达维度 (5个):**
    1.  `智能体 (Bots)`
    2.  `工作流 (Workflows)`
    3.  `知识库 (Knowledge)`
    4.  `云设备 (Devices)`
    5.  `工具开发 (Tools)`
*   **度量指标 (0-100分):**
    *   **智能体:** `(人均调用次数 / 平台基准人均调用次数) * 100`。 (注: 基准值可设为所有付费租户的75分位值，此项用于衡量相对使用深度。)
    *   **工作流:** **执行成功率** `(成功运行次数 / 总运行次数) * 100`。
    *   **知识库:** **容量使用率** `(已用容量 / 套餐总容量) * 100`。
    *   **云设备:** **付费转化率** `(积分抵扣时长 / 总使用时长) * 100`。
    *   **工具开发:** **成员渗透率** `(创建过工具的去重成员数 / 总成员数) * 100`。
*   **交互:** 鼠标悬浮在雷达图的任意一个角点上，会显示该维度的具体名称和分数。

#### **3.2. 时间线 (Timeline)**

*   **UI:** 按时间倒序排列的事件流。
*   **聚合事件源:**
    *   **系统告警:** `积分余额低于10%`、`关键资产调用失败率过高`。
    *   **运营操作:** `[王五] 将成员席位上限调整为150`、`[李四] 添加了备注`。
    *   **用户关键行为:** `所有者 [张三] 登录`、`套餐升级为企业版`。
    *   **订阅事件:** `套餐到期`、`续费成功`。

好的，我们跳过“时间线”模块，将其作为未来的规划。现在，让我们集中精力，对 **`消费分析 (Consumption Analysis)`** 标签页进行最深入、最严谨的细化设计。

这个页面的核心定位是**租户的“成本审计中心”**。它必须超越简单的数据罗列，为运营人员提供发现成本异常、评估消费效益、进行精细化归因的强大工具。

请将以下详细设计方案，替换或补充到您现有文档的 `#### 3.3. 消费分析 (Consumption Analysis)` 部分。

***

#### **3.3. 消费分析 (Consumption Analysis)**

**功能目标:** 提供一个强大的成本审计和效益分析中心。此页面旨在深入洞察租户的消费模式，回答以下关键问题：1. 租户的钱主要花在了哪里？ 2. 消费是否健康，是否存在异常或浪费？ 3. 投入的成本是否带来了对等的业务产出？

**全局筛选器:** 页面继承详情页顶部的全局时间范围选择器。

---

##### **模块一：消费总览与异动告警**

**功能描述:** 提供租户在周期内的顶层消费数据快照，并主动告警需要立即关注的消费异常。

*   **1.1. 核心指标 (KPI Cards):**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **总消耗积分** | `SUM(周期内所有消耗记录的积分)` |
    | **日均消耗** | `总消耗积分 / 周期天数` |
    | **消费成员数/占比** | `周期内产生消耗的去重成员数` / `总成员数` |
    | **最高单日消耗** | `MAX(每日消耗积分总和)`，并显示其发生的日期。 |
*   **1.2. 消费异动告警 (Consumption Anomaly Alerts):**
    *   **UI:** 页面顶部的一个可手动关闭的Banner横幅，仅在检测到异常时显示。
    *   **触发逻辑:** 系统每日扫描，`IF 某成员昨日消耗 > (其过去7日日均消耗 * 10) AND 其昨日消耗 > 1000积分`，则生成一条告警。
    *   **告警示例:** “**消费异动告警:** 成员 `[张三]` 昨日Token消耗 (15,000积分) 较其前7日均值 (800积分) 剧增 **1775%**。 `[查看该成员消费明细]`”。

---

##### **模块二：成本效益矩阵 (Cost-Benefit Matrix)**

**功能描述:** 通过一张散点图，将成员的“投入”（消耗）与“产出”（行为）进行关联分析，快速识别不同价值类型的成员。

*   **图表类型:** 散点图
*   **业务目标:** 直观地将成员分为四类：明星用户、高效用户、问题用户、待激活用户。
*   **X轴 (业务产出):** **周期内资产调用/运行总次数**。此指标代表了成员利用平台创造业务价值的活跃度。
*   **Y轴 (成本投入):** **周期内消耗总积分**。
*   **数据点:** 每个点代表租户下的一个成员。
*   **UI与交互:**
    *   **四象限:** 图表背景以中位数为界，清晰地划分为四个象限，并带有文本标签：
        *   **右上 (高产出-高消耗):** 明星用户
        *   **左上 (低产出-高消耗):** **问题用户 (需重点关注)**
        *   **右下 (高产出-低消耗):** 高效用户
        *   **左下 (低产出-低消耗):** 待激活用户
    *   **数据展示:** 默认展示周期内**消耗积分Top 30**的成员，避免大量低消耗用户挤占图表空间。提供一个 `[显示全部]` 的开关。
    *   **筛选:** 图表上方提供“用户组”筛选器，可按部门查看成本效益分布。
    *   **悬浮:** 鼠标悬浮在任意数据点上，会显示一个Tooltip卡片，包含该成员的 `姓名`、`消耗积分` 和 `产出次数`。

---

##### **模块三：消费构成深度分析**

**功能描述:** 将总消费分解到具体的资源类型，并提供多维度的图表和排行榜进行深度分析。

*   **布局:** 此模块内部分为两个子标签页或可展开的区域：`Token 消费分析` 和 `设备时长消费分析`。

*   **3.1. Token 消费分析:**
    *   **KPIs:** `Token总消耗积分`, `输入/输出Token占比`, `总消耗Tokens (Input/Output)`, `平均每百万Token成本 (CPM)`。
    *   **图表一: Token成本与用量关联趋势 (组合图)**
        *   **业务目标:** 揭示成本变化是由“用量增加”还是“单价提升”（切换了更贵的模型）导致。
        *   **X轴:** 时间
        *   **Y1轴 (左, 堆叠柱状图):** Token用量 (单位: a + b Tokens)。数据系列：`输入Token数`, `输出Token数`。
        *   **Y2轴 (右, 折线图):** Token消耗积分 (单位: 点)。
    *   **图表二: 按模型消耗排行 (水平条形图)**
        *   **业务目标:** 定位成本最高的模型。
        *   **Y轴:** 模型名称 (e.g., `GPT-4o`, `Claude 3 Sonnet`)
        *   **X轴:** 消耗积分。
    *   **数据表格: 按成员Token消耗排行**
        *   **列:** `排名`, `成员`, `所属用户组`, `消耗积分 (占租户总量%)`, `Token总用量 (输入/输出)`, `最常用模型`。

*   **3.2. 设备时长消费分析:**
    *   **KPIs:** `设备总消耗积分`, `总使用时长 (云电脑 vs 云手机)`, `总抵扣时长 (云电脑 vs 云手机)`。
    *   **图表一: 设备使用时长趋势 (双折线图)**
        *   **业务目标:** 对比用户在不同设备上的使用偏好和趋势。
        *   **X轴:** 时间
        *   **Y轴:** 使用时长 (单位: 分钟)
        *   **数据系列:** 一条线代表 `云电脑`, 另一条代表 `云手机`。
    *   **数据表格: 按成员设备消耗排行**
        *   **列:** `排名`, `成员`, `所属用户组`, `消耗积分`, `总使用时长`, `积分抵扣时长`, `主要使用设备`。

---

##### **模块四：数据下钻入口**

**功能描述:** 提供通往最原始、最完整的消费流水的入口，用于终极审计和数据导出。

*   **UI:** 在页面底部，提供一个非常醒目的主操作按钮。
*   **按钮:** `[ 查看完整消费明细流水 ]`
*   **交互:** 点击后，跳转到一个**新的全屏页面**。该页面是一个功能强大的数据网格 (Data Grid)，包含所有原始消费记录，并支持按 `资源类型`、`行为`、`成员`、`时间` 等多个维度进行高级筛选、排序和CSV导出。

好的，收到指令。

接下来，我们将对 **`资产分析 (Asset Analysis)`** 标签页进行全面的、细致入微的设计。

此页面的定位是**租户的“数字资产负债表”**。它不仅要清晰地盘点租户在平台上的所有“资产”（创建了什么），更要揭示这些资产的“效益”（带来了什么价值，是否被有效利用）。这将是评估租户平台使用深度、识别关键依赖、发现潜在问题的核心阵地。

请将以下详细设计方案，替换或补充到您现有文档的 `#### 3.4. 资产分析 (Asset Analysis)` 部分。

***

#### **3.4. 资产分析 (Asset Analysis)**

**功能目标:** 全面盘点并深入分析租户在平台创建的所有数字资产。此页面旨在回答以下关键问题：1. 租户的资产规模和构成是怎样的？ 2. 哪些资产是租户业务的核心（高频使用、高依赖度）？ 3. 哪些资产存在闲置或问题（从未被使用、高失败率）？ 4. 谁是租户内部的核心资产创建者？

**页面布局:** 采用“左侧导航 + 右侧内容区”的经典布局，让运营可以在不同资产类型之间轻松切换。

*   **左侧导航:**
    *   `总览 (Overview)`
    *   `智能体 (Bots)`
    *   `工作流 (Workflows)`
    *   `知识库 (Knowledge Bases)`
    *   `工具 (Tools)`
    *   `工具库 (Tool Libraries)`
    *   `空间 (Spaces)`
*   **关键资产识别机制:**
    *   **自动标记:** 系统每日计算，将 `采纳率 > 50%` 或 `调用量排名前5%` 的资产自动标记为“关键”。
    *   **手动覆盖:** 运营可在各类资产清单中，通过点击星标 `☆` 来手动添加或移除“关键”标记。

---

##### **4.1. 资产总览 (Overview)**

**功能描述:** 提供一个跨所有资产类型的高阶视图，宏观展示租户的资产健康度和构成。

*   **模块一：核心指标 (KPI Cards)**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **资产总数** | `SUM(所有类型资产的数量)` |
    | **关键资产数** | `COUNT(被标记为“关键”的资产)` |
    | **整体资产使用率** | `(周期内被使用过的去重资产数 / 资产总数) * 100` |
    | **最高产成员** | 周期内创建资产数量最多的成员（头像+名称）。 |
*   **模块二：诊断图表**
    *   **图表一: 资产创建趋势 (Asset Creation Trend)**
        *   **图表类型:** 堆叠柱状图
        *   **业务目标:** 展示租户资产库随时间的增长情况和构成变化。
        *   **X轴:** **时间** (按“周”或“月”聚合)。
        *   **Y轴:** **创建数量** (单位: 个)。
        *   **数据系列 (堆叠):** `智能体`, `工作流`, `知识库`, `工具`, `工具库`, `空间`。
    *   **图表二: 创建 vs. 使用 对比 (Creation vs. Usage)**
        *   **图表类型:** 分组条形图
        *   **业务目标:** 快速识别各类资产的闲置情况（即“僵尸资产”）。
        *   **X轴:** **资产类型** (`智能体`, `工作流`, ...)。
        *   **Y轴:** **数量** (单位: 个)。
        *   **数据系列 (分组):**
            *   **Bar 1 (深色):** 该类型的**资产总数**。
            *   **Bar 2 (浅色):** 该类型在周期内**被使用过的资产数**。

---

##### **4.2. 智能体 (Bots) 视图**

**功能描述:** 深度分析租户创建的所有智能体资产。

*   **模块一：核心指标 (KPI Cards)**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **智能体总数** | `COUNT(该租户下的所有智能体)` |
    | **总调用次数** | `SUM(周期内所有智能体的调用次数)` |
    | **平均调用失败率** | `(周期内总调用失败次数 / 总调用次数) * 100` |
    | **成员采纳率** | `(周期内至少调用过1次智能体的去重成员数 / 租户总活跃成员数) * 100` |
*   **模块二：分析图表**
    *   **图表一: Top 10 智能体 - 按调用次数 (Horizontal Bar Chart)**
    *   **图表二: Top 10 智能体 - 按调用失败率 (Horizontal Bar Chart)**
*   **模块三：智能体资产清单 (数据表格)**
    *   **功能:** 支持按`名称`搜索，按`状态`筛选，按各数值列排序。
    *   **列定义:**
        | 列名称 | 描述 |
        | :--- | :--- |
        | **名称** | 智能体名称 |
        | **状态** | `已发布` / `草稿` |
        | **标记** | `☆` (是否为关键资产) |
        | **调用次数** | 周期内总调用次数 |
        | **失败率** | `(调用失败次数 / 总调用次数) * 100` |
        | **采纳率** | `(使用过此智能体的去重成员数 / 租户总活跃成员数) * 100` |
        | **创建人** | 创建该智能体的成员 |
        | **最后更新时间** | `YYYY-MM-DD HH:mm` |

---

##### **4.3. 工作流 (Workflows) 视图**

**功能描述:** 深度分析租户创建的所有工作流资产。

*   **模块一：核心指标 (KPI Cards)**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **工作流总数** | `COUNT(该租户下的所有工作流)` |
    | **总运行次数** | `SUM(周期内所有工作流的运行次数)` |
    | **平均运行成功率** | `(周期内总成功运行次数 / 总运行次数) * 100` |
    | **平均运行时长** | `AVG(周期内所有成功运行工作流的持续时间)` (单位: 秒) |
*   **模块二：分析图表**
    *   **图表一: Top 10 工作流 - 按运行次数 (Horizontal Bar Chart)**
    *   **图表二: Top 10 工作流 - 按失败率 (Horizontal Bar Chart)**
*   **模块三：工作流资产清单 (数据表格)**
    *   **列定义:** `名称`, `状态`, `标记`, `运行次数`, **`成功率`**, `平均时长(秒)`, `创建人`, `最后更新时间`。

---

##### **4.4. 知识库 (Knowledge Bases) 视图**

**功能描述:** 深度分析租户创建的所有知识库资产。

*   **模块一：核心指标 (KPI Cards)**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **知识库总数** | `COUNT(该租户下的所有知识库)` |
    | **总占用容量** | `SUM(所有知识库的存储容量)` (单位: GB) |
    | **总文件数** | `SUM(所有知识库包含的文件总数)` |
    | **总被引用次数** | `SUM(每个知识库被智能体/工作流引用的次数)` |
*   **模块二：分析图表**
    *   **图表一: Top 10 知识库 - 按占用容量 (Horizontal Bar Chart)**
    *   **图表二: Top 10 知识库 - 按被引用次数 (Horizontal Bar Chart)**
*   **模块三：知识库资产清单 (数据表格)**
    *   **列定义:** `名称`, `状态` (`可用`/`不可用`), `标记`, **`占用容量`**, **`文件数`**, **`被引用次数`**, `创建人`, `最后更新时间`。

---

##### **4.5. 工具 (Tools) 视图**

**功能描述:** 深度分析租户创建的、作为能力单元的“工具”资产。

*   **模块一：核心指标 (KPI Cards)**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **工具总数** | `COUNT(该租户下的所有工具)` |
    | **总调用次数** | `SUM(周期内所有工具的调用次数)` |
    | **总被引用数** | `SUM(每个工具被智能体/工作流引用的次数)` |
    | **平均调用失败率** | `(周期内总调用失败次数 / 总调用次数) * 100` |
*   **模块二：分析图表**
    *   **图表一: Top 10 工具 - 按调用次数 (Horizontal Bar Chart)**
    *   **图表二: Top 10 工具 - 按被引用次数 (Horizontal Bar Chart)**
*   **模块三：工具资产清单 (数据表格)**
    *   **列定义:** `名称`, `所属工具库`, `状态` (`可用`/`不可用`), `标记`, `调用次数`, `失败率`, `被引用次数`, `创建人`。

---

##### **4.6. 工具库 (Tool Libraries) 视图**

**功能描述:** 分析作为“工具”容器的工具库资产。

*   **模块一：核心指标 (KPI Cards)**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **工具库总数** | `COUNT(该租户下的所有工具库)` |
    | **工具总数** | `SUM(所有工具库下的工具数量)` |
    | **发布率** | `(状态为“已发布”的工具库数 / 工具库总数) * 100` |
    | **最受欢迎的工具库** | 被引用次数最多的工具库名称。 |
*   **模块二：分析图表**
    *   **图表一: Top 10 工具库 - 按工具数量 (Horizontal Bar Chart)**
    *   **图表二: Top 10 工具库 - 按总调用次数 (Horizontal Bar Chart)**
*   **模块三：工具库资产清单 (数据表格)**
    *   **列定义:** `名称`, `状态` (`已发布`/`草稿`), `工具数`, `总调用次数`, `总被引用次数`, `创建人`。

---

##### **4.7. 空间 (Spaces) 视图**

**功能描述:** 分析作为协作和组织单元的“空间”资产。

*   **模块一：核心指标 (KPI Cards)**
    | 指标名称 | 指标计算与定义 |
    | :--- | :--- |
    | **空间总数** | `COUNT(该租户下的所有空间)` |
    | **空间内成员总数** | `COUNT(所有空间内的去重成员数)` |
    | **空间内资产总数** | `SUM(所有空间内的资产总数)` |
    | **最活跃的空间** | 周期内资产调用/运行次数最多的空间。 |
*   **模块二：分析图表**
    *   **图表一: Top 10 空间 - 按成员数 (Horizontal Bar Chart)**
    *   **图表二: Top 10 空间 - 按资产数 (Horizontal Bar Chart)**
*   **模块三：空间资产清单 (数据表格)**
    *   **列定义:** `空间名称`, `类型` (`个人`/`团队`), `所有者`, `成员数`, `资产数`, `总调用次数`, `创建时间`。



#### **3.5. 成员与权限 (Members & Permissions)**

*   **子标签页布局:** `成员列表`, `角色与权限`, `操作日志`。
*   **成员列表:** 支持创建/管理 **用户组**，并按组进行筛选和批量操作。
*   **角色与权限:** 支持创建自定义角色，并通过权限树勾选精细化权限。
*   **操作日志:** 记录本模块下的所有关键操作，用于安全审计。

好的，我们来完成最后一块核心拼图。

**`订阅与计费 (Subscription & Billing)`** 标签页是连接产品价值与商业成功的桥梁。它必须为运营人员提供水晶般清晰的视图，来管理和审计租户的整个商业生命周期，从首次订阅、资源使用，到续费和历史追溯。

此页面的设计必须同时满足 **“快速概览”** 和 **“精确管理”** 的双重需求。

请将以下详细设计方案，替换或补充到您现有文档的 `#### 3.6. 订阅与计费 (Subscription & Billing)` 部分。

***

#### **3.6. 订阅与计费 (Subscription & Billing)**

**功能目标:** 提供一个集中的商业化管理中心，用于查看租户当前的订阅状态、实时监控资源配额使用情况、管理套餐变更，并提供完整的历史账单与订阅记录以备审计。

**页面布局:** 采用清晰的多卡片模块化布局，自上而下依次为：当前订阅、资源配额、套餐变更历史、账单历史。

---

##### **模块一：当前订阅计划 (Current Subscription Plan)**

**功能描述:** 在页面最顶部，用一个独立卡片清晰地展示租户当前的核心商业化信息和可执行的关键操作。

*   **UI:** 一个信息卡片，左侧为信息，右侧为操作按钮。
*   **信息区 (左侧):**
    *   **套餐名称:** `企业版`
    *   **订阅状态:** `生效中 (剩余 250 天)` - 状态根据实际情况高亮，如 `试用中`, `已到期`。
    *   **订阅周期:** `2025-01-01` 至 `2025-12-31`
    *   **下次续费日:** `2026-01-01`
    *   **合同金额:** `￥50,000 / 年`
*   **操作区 (右侧):**
    *   `[变更套餐]`: 核心管理操作，点击后弹出 `变更套餐模态框` (交互逻辑同顶部核心操作区)。
    *   `[发起续费提醒]`: 点击后弹出 `发送通知模态框`，并自动填充一个续费提醒的模板。
    *   `[取消订阅]`: **高危操作**。点击后触发二次确认模态框，要求输入 `取消订阅` 字样，并明确告知取消后将在当前周期结束后失效。

---

##### **模块二：资源配额用量 (Resource Quota Usage)**

**功能描述:** 实时、可视化地监控租户各项资源的消耗情况，并提供用量预警和手动调整入口。

*   **UI:** 一个数据列表或表格。
*   **右上角操作:**
    *   **`[调整配额]` 按钮 (运营可见):** 点击后，触发`修改配额模态框`。
        *   **弹窗字段:** `配额项 (下拉框)`, `调整类型 (覆盖/追加)`, `新值 (数字输入框)`, `调整原因 (下拉框, 必选)`, `备注 (可选文本框)`。
*   **列表/表格列定义:**
    | 资源项 | 用量可视化 | 状态/预测 |
    | :--- | :--- | :--- |
    | **积分** | **`[ 80% ]`** 8,000,000 / 10,000,000 | ⚠️ **预警:** 预计可用15天 |
    | **成员席位** | **`[ 98% ]`** 98 / 100 | 🚨 **危险:** 即将满额 |
    | **知识库容量** | **`[ 45% ]`** 4.5TB / 10TB | ✅ **正常:** 消耗平稳 |
    | **云电脑免费时长** | **`[ 100% ]`** 10,000 / 10,000 分钟 | ℹ️ **信息:** 已用尽，超出部分将消耗积分 |
    *   **用量预测逻辑:** `当前余量 / 近30日日均消耗`，得出预计可用天数。

---

##### **模块三：套餐变更历史 (Plan Change History)**

**功能描述:** 提供一份不可篡改的审计日志，记录该租户历史上的每一次套餐变更事件。

*   **UI:** 一个按时间倒序排列的数据表格。
*   **列定义:**
    | 生效日期 | 变更类型 | 原套餐 | 新套餐 | 合同金额 | 操作人 |
    | :--- | :--- | :--- | :--- | :--- | :--- |
    | `2025-01-01` | **升级** | 团队版 | 企业版 | `￥50,000` | `[运营: 王五]` |
    | `2024-01-01` | **新购** | - | 团队版 | `￥15,000` | `[用户: 张三]` |

---

##### **模块四：账单历史 (Billing History)**

**功能描述:** 汇总租户的所有历史账单，用于财务对账和查询。

*   **UI:** 一个按时间倒序排列的数据表格。
*   **列定义:**
    | 账单ID | 创建日期 | 账单周期 | 类型 | 金额 | 状态 | 操作 |
    | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
    | `INV-2025-001`|`2025-01-01`| `2025/01/01-2025/12/31` | 升级 |`￥50,000`| `已支付` | `[下载]` |
    | `INV-2024-153`|`2024-01-01`| `2024/01/01-2024/12/31` | 新购 |`￥15,000`| `已支付` | `[下载]` |
*   **操作:** 点击`[下载]`按钮，可下载该期账单的PDF文件。

好的，我们来完成方案的最后一部分，也是至关重要的一部分：**`租户设置 (Settings)`**。

这个页面的定位是**租户的“后台控制室”**。它专门收纳那些不常用、但权限极高、影响重大的管理配置项。页面的核心设计原则是**安全、清晰、可追溯**。每一个操作都必须有明确的意图和完整的日志记录。

请将以下详细设计方案，替换或补充到您现有文档的 `#### 3.7. 租户设置 (Settings)` 部分。

***

#### **3.7. 租户设置 (Settings)**

**功能目标:** 提供一个统一、安全的管理界面，用于配置租户的基础信息、安全策略、功能权限等高级设置。此页面下的所有操作都应被视为高权限行为，并被详细记录。

**页面布局:** 采用“左侧导航 + 右侧内容区”的经典后台布局，确保各项设置分类清晰，互不干扰。

*   **左侧导航菜单:**
    *   `基础信息 (Basic Info)`
    *   `安全设置 (Security)`
    *   `功能开关 (Feature Flags)`
    *   `运营备注 (Operator Notes)`
    *   `数据管理 (Data Management)`
    *   `操作日志 (Audit Log)`

---

##### **7.1. 基础信息 (Basic Info)**

**功能描述:** 管理租户最基本的核心身份信息。

*   **UI:** 一个标准的表单。
*   **表单项:**
    *   **租户名称:**
        *   **组件:** 文本输入框。
        *   **校验:** 必填，长度限制。
    *   **租户Logo:**
        *   **组件:** 图片上传控件，带预览功能。
        *   **说明:** 建议尺寸 128x128px, 小于2MB。
    *   **所有者:**
        *   **组件:** 支持远程搜索的用户选择器。
        *   **安全:** 此为**高危操作**。当运营人员修改此项并点击保存时，会弹出一个二次确认模态框，要求操作者 **“重新输入自己的登录密码”** 以完成身份验证。
*   **操作:** 页面底部有一个 `[保存更改]` 按钮。

---

##### **7.2. 安全设置 (Security)**

**功能描述:** 配置与租户访问安全相关的策略。

*   **模块一：IP白名单**
    *   **功能:** 限制只有在白名单内的IP地址才能访问该租户下的资源。
    *   **UI:**
        *   一个开关按钮 `[ 启用IP白名单 ]`。
        *   一个多行文本域，用于批量添加IP地址（每行一个，支持CIDR格式如 `192.168.1.0/24`）。
        *   一个 `[添加]` 按钮。
        *   下方是一个列表，展示已添加的白名单IP，每行都有 `[删除]` 操作。
*   **模块二：API密钥管理**
    *   **功能:** 为租户生成和管理用于API调用的密钥。
    *   **UI:**
        *   一个 `[+ 生成新密钥]` 按钮。点击后弹出模态框，要求填写`密钥名称`，生成后显示密钥（**仅显示一次**），并提示用户立即复制保存。
        *   下方是密钥列表，包含 `名称`, `Key前缀`, `创建时间`, `状态(启用/禁用)`, `操作([禁用]/[删除])`。

---

##### **7.3. 功能开关 (Feature Flags)**

**功能描述:** 为租户开启或关闭特定的灰度功能或增值服务模块。

*   **UI:** 一个功能列表，每一行代表一个可配置的功能。
*   **列表列定义:**
    | 功能名称 | 功能描述 | 状态 |
    | :--- | :--- | :--- |
    | AI生成报告 V2 Beta | 启用新版AI报告生成引擎，提供更深度的数据洞察。 | `[ 开 | 关 ]` (Toggle Switch) |
    | 外部工具集成 | 允许租户在工作流中连接和调用外部API工具。 | `[ 开 | 关 ]` (Toggle Switch) |

---

##### **7.4. 运营备注 (Operator Notes)**

**功能描述:** 内部使用的客户跟进记录本，用于沉淀非结构化的重要沟通信息。

*   **UI:**
    *   顶部是一个多行文本域，用于输入新的备注内容。
    *   一个 `[添加备注]` 按钮。
    *   下方是一个按时间倒序排列的备注历史列表。
*   **备注卡片结构:** 每个历史备注都是一个独立的卡片，包含：
    *   **备注内容:**
    *   **操作人:** `[运营: 王五]`
    *   **时间戳:** `2025-10-10 18:00:00`

---

##### **7.5. 数据管理 (Data Management)**

**功能描述:** 提供租户生命周期终点的管理操作，此区域为**高危操作区**。

*   **UI:** 一个带有明显警告色（如红色边框）的独立卡片区域。
*   **操作：归档租户 (Archive Tenant)**
    *   **按钮:** `[ ... 归档租户 ]`
    *   **交互:**
        1.  点击后，触发**严重警告模态框**。
        2.  **模态框内容:**
            *   **标题:** `严重警告：确认归档租户 [租户名称]？`
            *   **警告信息:** “此操作不可逆！归档后，该租户将立即被禁用且无法访问。所有数据将在 **180天** 后被永久删除。请确认您理解此操作的后果，并输入租户的名称 `[租户名称]` 以继续。”
            *   **确认输入框:**
            *   **操作按钮:** `[我已了解后果，确认归档]` (在输入框内容完全匹配租户名称后启用)。

---

##### **7.6. 操作日志 (Audit Log)**

**功能描述:** 记录所有在`租户设置`页面下发生的关键操作，用于安全审计和问题追溯。

*   **UI:** 一个带筛选功能的数据表格。
*   **筛选器:** `时间范围选择器`, `操作人(可搜索)`, `操作类型(下拉框)`。
*   **表格列定义:**
    | 时间戳 | 操作人 | 操作IP | 操作类型 | 操作详情 |
    | :--- | :--- | :--- | :--- | :--- |
    | `2025-10-10 18:00` |`王五`|`202.11.22.33`| 修改配置 | 将“IP白名单”启用 |
    | `2025-10-09 15:30` |`李四`|`202.11.22.34`| 修改基础信息 | 将“所有者”从`张三`变更为`赵六` |