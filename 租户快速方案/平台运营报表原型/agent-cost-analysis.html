<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ™ºèƒ½ä½“æˆæœ¬ä¸ä½¿ç”¨åˆ†æ</title>
  
  <!-- Element Plus CSS -->
  <link rel="stylesheet" href="https://unpkg.com/element-plus@2.4.4/dist/index.css">
  
  <!-- é£ä¹¦è®¾è®¡ç³»ç»Ÿ -->
  <link rel="stylesheet" href="./assets/css/feishu-design.css">
  
  <style>
    body {
      margin: 0;
      padding: var(--spacing-6) var(--spacing-8);
      background: #F7F8FA;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
    }
    
    .page-header {
      background: #FFFFFF;
      border-radius: 12px;
      padding: var(--spacing-6) var(--spacing-7);
      margin-bottom: var(--spacing-5);
      box-shadow: 0 1px 2px 0 rgba(31, 35, 41, 0.05);
      border: 1px solid rgba(31, 35, 41, 0.05);
    }
    
    .page-title {
      font-size: 20px;
      font-weight: 600;
      color: #1F2329;
      margin: 0;
      line-height: 28px;
    }
    
    .filter-toolbar {
      background: #FFFFFF;
      border-radius: 12px;
      padding: var(--spacing-5) var(--spacing-6);
      margin-bottom: var(--spacing-5);
      box-shadow: 0 1px 2px 0 rgba(31, 35, 41, 0.05);
      border: 1px solid rgba(31, 35, 41, 0.05);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: var(--spacing-4);
    }
    
    .filter-group {
      display: flex;
      align-items: center;
      gap: var(--spacing-3);
    }
    
    .filter-label {
      font-size: 14px;
      color: #646A73;
      white-space: nowrap;
      font-weight: 500;
    }
    
    /* å¿«æ·å¯¼èˆªé”šç‚¹ */
    .anchor-nav {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 12px 20px;
      margin-bottom: var(--spacing-5);
      box-shadow: 0 1px 2px 0 rgba(31, 35, 41, 0.05);
      border: 1px solid rgba(31, 35, 41, 0.05);
      position: sticky;
      top: 16px;
      z-index: 100;
    }
    
    .anchor-nav-list {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .anchor-nav-item {
      color: #646A73;
      text-decoration: none;
      font-size: 14px;
      padding: 6px 12px;
      border-radius: 6px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      font-weight: 500;
    }
    
    .anchor-nav-item:hover {
      background: rgba(51, 112, 255, 0.08);
      color: #3370FF;
    }
    
    .anchor-nav-item:active {
      transform: scale(0.98);
    }
    
    /* KPIå¡ç‰‡ç½‘æ ¼ */
    .kpi-grid-8 {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: var(--spacing-5);
    }
    
    .kpi-card {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 20px;
      border: 1px solid rgba(31, 35, 41, 0.05);
      box-shadow: 0 1px 2px 0 rgba(31, 35, 41, 0.05);
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }
    
    .kpi-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #3370FF 0%, #5B8EFF 100%);
      opacity: 0;
      transition: opacity 0.2s;
    }
    
    .kpi-card:hover {
      border-color: rgba(51, 112, 255, 0.2);
      box-shadow: 0 4px 12px 0 rgba(51, 112, 255, 0.12);
      transform: translateY(-2px);
    }
    
    .kpi-card:hover::before {
      opacity: 1;
    }
    
    .kpi-card:active {
      transform: translateY(0);
    }
    
    .kpi-label {
      font-size: 13px;
      color: #8F959E;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 4px;
      font-weight: 500;
    }
    
    .kpi-value {
      font-size: 28px;
      font-weight: 600;
      color: #1F2329;
      margin-bottom: 4px;
      line-height: 1.3;
      letter-spacing: -0.3px;
    }
    
    /* KPIå€¼ç‰¹æ®Šæ ·å¼ */
    .kpi-card:nth-child(1) .kpi-value,
    .kpi-card:nth-child(2) .kpi-value {
      color: #3370FF;
    }
    
    .kpi-card:nth-child(3) .kpi-value,
    .kpi-card:nth-child(4) .kpi-value {
      color: #00B42A;
    }
    
    .kpi-card:nth-child(5) .kpi-value,
    .kpi-card:nth-child(6) .kpi-value {
      color: #FF7D00;
    }
    
    .kpi-card:nth-child(7) .kpi-value,
    .kpi-card:nth-child(8) .kpi-value {
      color: #F53F3F;
    }
    
    .kpi-desc {
      font-size: 12px;
      color: #8F959E;
      line-height: 1.4;
      margin-top: 4px;
    }
    
    /* å›¾è¡¨å¡ç‰‡ */
    .chart-card {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 1px 2px 0 rgba(31, 35, 41, 0.05);
      border: 1px solid rgba(31, 35, 41, 0.05);
      margin-bottom: 24px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .chart-card:hover {
      box-shadow: 0 4px 12px 0 rgba(31, 35, 41, 0.08);
    }
    
    .chart-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(31, 35, 41, 0.06);
    }
    
    .chart-title {
      font-size: 16px;
      font-weight: 600;
      color: #1F2329;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .chart-title::before {
      content: '';
      width: 3px;
      height: 16px;
      background: #3370FF;
      border-radius: 2px;
    }
    
    .chart-container {
      width: 100%;
      height: 400px;
    }
    
    .chart-container-large {
      height: 420px;
    }
    
    /* æ˜ç»†è¡¨ */
    .detail-table-wrapper {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 1px 2px 0 rgba(31, 35, 41, 0.05);
      border: 1px solid rgba(31, 35, 41, 0.05);
      margin-bottom: var(--spacing-5);
    }
    
    .table-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    
    .section-title {
      font-size: 18px;
      font-weight: 600;
      color: #1F2329;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      line-height: 28px;
      position: relative;
      padding-left: 14px;
    }
    
    .section-title::before {
      content: '';
      position: absolute;
      left: 0;
      width: 3px;
      height: 20px;
      background: #3370FF;
      border-radius: 2px;
    }
    
    /* è¿è¥è¡ŒåŠ¨å»ºè®® */
    .insights-section {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 1px 2px 0 rgba(31, 35, 41, 0.05);
      border: 1px solid rgba(31, 35, 41, 0.05);
      margin-bottom: 24px;
    }
    
    .insight-item {
      margin-bottom: 16px;
      padding: 20px;
      background: #F7F8FA;
      border-radius: 8px;
      border-left: 3px solid #3370FF;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }
    
    .insight-item:last-child {
      margin-bottom: 0;
    }
    
    .insight-item:hover {
      background: #F2F3F5;
      transform: translateX(4px);
      box-shadow: 0 2px 8px rgba(51, 112, 255, 0.08);
    }
    
    .insight-title {
      font-size: 15px;
      font-weight: 600;
      color: #1F2329;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .insight-title::before {
      content: 'ğŸ’¡';
      font-size: 18px;
      line-height: 1;
    }
    
    .insight-content {
      font-size: 14px;
      color: #646A73;
      line-height: 1.6;
      margin-bottom: 10px;
    }
    
    .insight-action {
      font-size: 13px;
      color: #3370FF;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(51, 112, 255, 0.08);
      border-radius: 6px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .insight-action:hover {
      background: rgba(51, 112, 255, 0.12);
      color: #1F5ADB;
    }
    
    .insight-action::before {
      content: 'â†’';
      font-weight: bold;
      font-size: 14px;
    }
    
    .tooltip-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #E5E6EB;
      color: #8F959E;
      font-size: 11px;
      font-weight: 600;
      cursor: help;
      transition: all 0.2s;
      margin-left: 4px;
      font-style: normal;
    }
    
    .tooltip-icon:hover {
      background: #3370FF;
      color: #FFFFFF;
      transform: scale(1.1);
    }
    
    /* æŒ‡æ ‡åˆ‡æ¢å™¨ */
    .metric-switcher {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    /* Element Plus é£ä¹¦é£æ ¼è¦†ç›– */
    .el-tabs__nav-wrap::after {
      background-color: rgba(31, 35, 41, 0.06);
      height: 1px;
    }
    
    .el-tabs__active-bar {
      background-color: #3370FF;
      height: 2px;
      border-radius: 1px;
    }
    
    .el-tabs__item {
      font-size: 14px;
      font-weight: 500;
      color: #646A73;
      padding: 0 20px;
      height: 48px;
      line-height: 48px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .el-tabs__item:hover {
      color: #3370FF;
    }
    
    .el-tabs__item.is-active {
      color: #3370FF;
      font-weight: 600;
    }
    
    .el-button--text {
      color: #3370FF;
      font-weight: 500;
      padding: 6px 12px;
      border-radius: 6px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .el-button--text:hover {
      background-color: rgba(51, 112, 255, 0.08);
      color: #1F5ADB;
    }
    
    .el-button--text:active {
      background-color: rgba(51, 112, 255, 0.12);
    }
    
    .el-table {
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid rgba(31, 35, 41, 0.06);
    }
    
    .el-table th.el-table__cell {
      background-color: #F7F8FA;
      color: #1F2329;
      font-weight: 600;
      font-size: 13px;
      padding: 12px 0;
      border-bottom: 1px solid rgba(31, 35, 41, 0.06);
    }
    
    .el-table td.el-table__cell {
      padding: 14px 0;
      border-bottom: 1px solid rgba(31, 35, 41, 0.06);
    }
    
    .el-table--striped .el-table__body tr.el-table__row--striped td.el-table__cell {
      background-color: #FAFBFC;
    }
    
    .el-table__row:hover > td.el-table__cell {
      background-color: rgba(51, 112, 255, 0.04) !important;
    }
    
    .el-pagination {
      font-weight: 500;
      margin-top: 20px;
    }
    
    .el-pagination.is-background .el-pager li:not(.is-disabled).is-active {
      background-color: #3370FF;
      color: #FFFFFF;
    }
    
    .el-pagination.is-background .el-pager li:not(.is-disabled):hover {
      color: #3370FF;
    }
    
    .el-select .el-input__wrapper {
      box-shadow: 0 0 0 1px rgba(31, 35, 41, 0.08) inset;
      border-radius: 8px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .el-select .el-input__wrapper:hover {
      box-shadow: 0 0 0 1px rgba(51, 112, 255, 0.3) inset;
    }
    
    .el-select .el-input.is-focus .el-input__wrapper {
      box-shadow: 0 0 0 1px #3370FF inset;
    }
    
    .el-date-editor.el-input__wrapper {
      box-shadow: 0 0 0 1px rgba(31, 35, 41, 0.08) inset;
      border-radius: 8px;
    }
    
    .el-date-editor.el-input__wrapper:hover {
      box-shadow: 0 0 0 1px rgba(51, 112, 255, 0.3) inset;
    }
    
    .el-button {
      border-radius: 8px;
      font-weight: 500;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .el-button--primary {
      background-color: #3370FF;
      border-color: #3370FF;
    }
    
    .el-button--primary:hover {
      background-color: #1F5ADB;
      border-color: #1F5ADB;
    }
    
    .el-button--default {
      background-color: #FFFFFF;
      border-color: rgba(31, 35, 41, 0.08);
      color: #1F2329;
    }
    
    .el-button--default:hover {
      background-color: #F7F8FA;
      border-color: rgba(31, 35, 41, 0.12);
    }
    
    /* æ°”æ³¡å›¾é…ç½®é¢æ¿ */
    .bubble-settings-panel {
      background: #F7F8FA;
      border-radius: 8px;
      padding: 20px;
      margin: 16px 20px;
      border: 1px solid rgba(31, 35, 41, 0.06);
    }
    
    .settings-row {
      display: flex;
      gap: 24px;
      margin-bottom: 20px;
    }
    
    .settings-row:last-child {
      margin-bottom: 0;
    }
    
    .settings-item {
      flex: 1;
    }
    
    .settings-item label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      color: #646A73;
      margin-bottom: 12px;
    }
    
    .slider-wrapper {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .slider-label {
      font-size: 12px;
      color: #86909C;
      min-width: 40px;
    }
    
    .slider-value {
      font-size: 12px;
      color: #3370FF;
      font-weight: 500;
      margin-top: 8px;
      text-align: center;
    }
    
    .el-slider {
      flex: 1;
    }
    
    .el-dialog {
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    }
    
    .el-dialog__header {
      padding: 20px 24px;
      border-bottom: 1px solid rgba(31, 35, 41, 0.06);
    }
    
    .el-dialog__title {
      font-size: 16px;
      font-weight: 600;
      color: #1F2329;
    }
    
    .el-dialog__body {
      padding: 24px;
    }
    
    .el-checkbox__input.is-checked .el-checkbox__inner {
      background-color: #3370FF;
      border-color: #3370FF;
    }
    
    .el-checkbox__input.is-checked + .el-checkbox__label {
      color: #1F2329;
      font-weight: 500;
    }
    
    .el-checkbox__label {
      font-size: 14px;
      color: #646A73;
    }
    
    .el-tag {
      border-radius: 6px;
      font-weight: 500;
      border: none;
    }
    
    .el-tag--success {
      background-color: rgba(0, 180, 42, 0.1);
      color: #00B42A;
    }
    
    .el-tag--info {
      background-color: rgba(51, 112, 255, 0.1);
      color: #3370FF;
    }
    
    .el-tag--warning {
      background-color: rgba(255, 125, 0, 0.1);
      color: #FF7D00;
    }
    
    /* å“åº”å¼ */
    @media (max-width: 1600px) {
      .kpi-grid-8 {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    
    @media (max-width: 1200px) {
      .kpi-grid-8 {
        grid-template-columns: repeat(2, 1fr);
      }
      
      body {
        padding: var(--spacing-4);
      }
    }
    
    @media (max-width: 768px) {
      .kpi-grid-8 {
        grid-template-columns: 1fr;
      }
    }
    
    /* é”šç‚¹åŒºåŸŸ */
    .anchor-section {
      scroll-margin-top: 100px;
    }
    
    /* å¹³æ»‘æ»šåŠ¨ */
    html {
      scroll-behavior: smooth;
    }
    
    /* åŠ è½½åŠ¨ç”» */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(16px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .anchor-section {
      animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    /* å¡ç‰‡å…¥åœºåŠ¨ç”» */
    .kpi-card {
      animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1) backwards;
    }
    
    .kpi-card:nth-child(1) { animation-delay: 0.03s; }
    .kpi-card:nth-child(2) { animation-delay: 0.06s; }
    .kpi-card:nth-child(3) { animation-delay: 0.09s; }
    .kpi-card:nth-child(4) { animation-delay: 0.12s; }
    .kpi-card:nth-child(5) { animation-delay: 0.15s; }
    .kpi-card:nth-child(6) { animation-delay: 0.18s; }
    .kpi-card:nth-child(7) { animation-delay: 0.21s; }
    .kpi-card:nth-child(8) { animation-delay: 0.24s; }
    
    /* å¡ç‰‡é˜´å½±æ•ˆæœä¼˜åŒ– */
    .chart-card,
    .detail-table-wrapper,
    .insights-section {
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    /* é¡µé¢åŠ è½½æ—¶çš„æ·¡å…¥æ•ˆæœ */
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
    
    body {
      animation: fadeIn 0.3s ease-out;
    }
    
    /* ç¾åŒ–æ»šåŠ¨æ¡ */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #F7F8FA;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #C9CDD4;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #86909C;
    }
    
    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #F7F8FA;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #C9CDD4;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #A8ABB2;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="page-header">
      <h1 class="page-title">ğŸ“Š æ™ºèƒ½ä½“æˆæœ¬ä¸ä½¿ç”¨åˆ†æ</h1>
    </div>
    
    <!-- å…¨å±€ç­›é€‰å™¨ -->
    <div class="filter-toolbar">
      <div class="filter-group">
        <span class="filter-label">æ—¶é—´èŒƒå›´ï¼š</span>
        <el-select v-model="timeRange" @change="handleTimeRangeChange" style="width: 180px;">
          <el-option label="ä»Šå¤©" value="today" />
          <el-option label="æœ€è¿‘7å¤©" value="7days" />
          <el-option label="æœ€è¿‘ä¸€ä¸ªæœˆ" value="30days" />
          <el-option label="æœ€è¿‘180å¤©" value="180days" />
          <el-option label="æœ€è¿‘ä¸€å¹´" value="365days" />
          <el-option label="è‡ªå®šä¹‰èŒƒå›´" value="custom" />
        </el-select>
        
        <el-date-picker
          v-if="timeRange === 'custom'"
          v-model="customDateRange"
          type="daterange"
          range-separator="è‡³"
          start-placeholder="å¼€å§‹æ—¥æœŸ"
          end-placeholder="ç»“æŸæ—¥æœŸ"
          @change="handleTimeRangeChange"
          style="width: 400px; margin-left: var(--spacing-3);"
        />
      </div>
      
      <div class="filter-group">
        <span class="filter-label">ç§Ÿæˆ·ï¼š</span>
        <el-select
          v-model="selectedTenants"
          multiple
          collapse-tags
          collapse-tags-tooltip
          placeholder="å…¨éƒ¨ç§Ÿæˆ·"
          style="width: 300px;"
          @change="handleTenantChange"
        >
          <el-option
            v-for="tenant in tenantList"
            :key="tenant.id"
            :label="tenant.name"
            :value="tenant.id"
          />
        </el-select>
      </div>
      
      <div class="filter-group">
        <el-button @click="handleRefresh" :loading="loading">
          åˆ·æ–°
        </el-button>
        <el-button @click="handleExport">
          å¯¼å‡º
        </el-button>
      </div>
    </div>
    
    <!-- å¿«æ·å¯¼èˆªé”šç‚¹ -->
    <div class="anchor-nav">
      <div class="anchor-nav-list">
        <a href="#kpi-section" class="anchor-nav-item" @click.prevent="scrollToAnchor('kpi-section')">å…³é”®æŒ‡æ ‡</a>
        <a href="#top10-section" class="anchor-nav-item" @click.prevent="scrollToAnchor('top10-section')">Top10è¶‹åŠ¿</a>
        <a href="#cost-analysis-section" class="anchor-nav-item" @click.prevent="scrollToAnchor('cost-analysis-section')">æˆæœ¬ä½¿ç”¨åˆ†æ</a>
        <a href="#distribution-section" class="anchor-nav-item" @click.prevent="scrollToAnchor('distribution-section')">ç¾¤ä½“åˆ†å¸ƒ</a>
        <a href="#detail-table-section" class="anchor-nav-item" @click.prevent="scrollToAnchor('detail-table-section')">è¯¦ç»†æ•°æ®è¡¨</a>
      </div>
    </div>
    
    <!-- æ™ºèƒ½ä½“å…³é”®æŒ‡æ ‡ -->
    <div id="kpi-section" class="anchor-section">
      <h2 class="section-title">ğŸ“ˆ æ™ºèƒ½ä½“å…³é”®æŒ‡æ ‡</h2>
      <div class="kpi-grid-8">
        <div class="kpi-card" v-for="kpi in agentKPIs" :key="kpi.key">
          <div class="kpi-label">
            {{ kpi.label }}
            <el-tooltip :content="kpi.tooltip" placement="top">
              <span class="tooltip-icon">i</span>
            </el-tooltip>
          </div>
          <div class="kpi-value">{{ kpi.value }}</div>
          <div class="kpi-desc" v-if="kpi.desc">{{ kpi.desc }}</div>
        </div>
      </div>
    </div>
    
    <!-- Top10è¶‹åŠ¿åˆ†æ -->
    <div id="top10-section" class="anchor-section">
      <h2 class="section-title">ğŸ† Top10è¶‹åŠ¿åˆ†æ</h2>
      
      <div class="chart-card">
        <el-tabs v-model="top10ActiveTab" @tab-change="handleTop10TabChange">
          <!-- Tokenæ¶ˆè€—Top10 -->
          <el-tab-pane label="Tokenæ¶ˆè€— Top10" name="tokens">
            <div class="chart-header" style="margin-top: var(--spacing-4);">
              <div class="chart-title">æ™ºèƒ½ä½“Tokenæ¶ˆè€— Top10 & è¶‹åŠ¿åˆ†æ</div>
              <div style="display: flex; gap: var(--spacing-2);">
                <el-button v-if="Download" text :icon="Download" @click="exportTop10Data('tokens')">å¯¼å‡º</el-button>
                <el-button v-else text @click="exportTop10Data('tokens')">å¯¼å‡º</el-button>
                <el-button v-if="Setting" text :icon="Setting" @click="showChartSettings = true">è®¾ç½®</el-button>
                <el-button v-else text @click="showChartSettings = true">è®¾ç½®</el-button>
              </div>
            </div>
            <div class="chart-container-large" id="token-top10-chart"></div>
            <el-table :data="tokenTop10Table" style="margin-top: var(--spacing-4);" stripe border>
              <el-table-column type="index" label="æ’è¡Œ" width="80" />
              <el-table-column prop="name" label="æ™ºèƒ½ä½“åç§°" />
              <el-table-column prop="totalTokens" label="æ€»Tokenæ¶ˆè€—">
                <template #default="{ row }">
                  {{ Utils.formatToken(row.totalTokens) }}
                </template>
              </el-table-column>
              <el-table-column prop="creator" label="åˆ›å»ºäºº" />
            </el-table>
          </el-tab-pane>
          
          <!-- è´¹ç”¨æ¶ˆè€—Top10 -->
          <el-tab-pane label="è´¹ç”¨æ¶ˆè€— Top10" name="cost">
            <div class="chart-header" style="margin-top: var(--spacing-4);">
              <div class="chart-title">æ™ºèƒ½ä½“è´¹ç”¨æ¶ˆè€— Top10 & è¶‹åŠ¿åˆ†æ</div>
              <div style="display: flex; gap: var(--spacing-2);">
                <el-button v-if="Download" text :icon="Download" @click="exportTop10Data('cost')">å¯¼å‡º</el-button>
                <el-button v-else text @click="exportTop10Data('cost')">å¯¼å‡º</el-button>
                <el-button v-if="Setting" text :icon="Setting" @click="showChartSettings = true">è®¾ç½®</el-button>
                <el-button v-else text @click="showChartSettings = true">è®¾ç½®</el-button>
              </div>
            </div>
            <div class="chart-container-large" id="cost-top10-chart"></div>
            <el-table :data="costTop10Table" style="margin-top: var(--spacing-4);" stripe border>
              <el-table-column type="index" label="æ’è¡Œ" width="80" />
              <el-table-column prop="name" label="æ™ºèƒ½ä½“åç§°" />
              <el-table-column prop="totalCost" label="æ€»è´¹ç”¨æ¶ˆè€—(ï¿¥)">
                <template #default="{ row }">
                  {{ Utils.formatCurrency(row.totalCost) }}
                </template>
              </el-table-column>
              <el-table-column prop="creator" label="åˆ›å»ºäºº" />
            </el-table>
          </el-tab-pane>
          
          <!-- è°ƒç”¨æ¬¡æ•°Top10 -->
          <el-tab-pane label="è°ƒç”¨æ¬¡æ•° Top10" name="calls">
            <div class="chart-header" style="margin-top: var(--spacing-4);">
              <div class="chart-title">æ™ºèƒ½ä½“è°ƒç”¨æ¬¡æ•° Top10 & è¶‹åŠ¿åˆ†æ</div>
              <div style="display: flex; gap: var(--spacing-2);">
                <el-button v-if="Download" text :icon="Download" @click="exportTop10Data('calls')">å¯¼å‡º</el-button>
                <el-button v-else text @click="exportTop10Data('calls')">å¯¼å‡º</el-button>
                <el-button v-if="Setting" text :icon="Setting" @click="showChartSettings = true">è®¾ç½®</el-button>
                <el-button v-else text @click="showChartSettings = true">è®¾ç½®</el-button>
              </div>
            </div>
            <div class="chart-container-large" id="calls-top10-chart"></div>
            <el-table :data="callsTop10Table" style="margin-top: var(--spacing-4);" stripe border>
              <el-table-column type="index" label="æ’è¡Œ" width="80" />
              <el-table-column prop="name" label="æ™ºèƒ½ä½“åç§°" />
              <el-table-column prop="totalCalls" label="æ€»è°ƒç”¨æ¬¡æ•°">
                <template #default="{ row }">
                  {{ Utils.formatNumber(row.totalCalls) }}
                </template>
              </el-table-column>
              <el-table-column prop="creator" label="åˆ›å»ºäºº" />
            </el-table>
          </el-tab-pane>
        </el-tabs>
      </div>
    </div>
    
    <!-- æˆæœ¬ä½¿ç”¨åˆ†æ -->
    <div id="cost-analysis-section" class="anchor-section">
      <h2 class="section-title">ğŸ’° æˆæœ¬ä½¿ç”¨åˆ†æ</h2>
      
      <!-- å››è±¡é™å›¾ -->
      <div class="chart-card">
        <div class="chart-header">
          <div class="chart-title">æ™ºèƒ½ä½“æˆæœ¬ vs. ä½¿ç”¨æƒ…å†µï¼ˆå››è±¡é™å›¾ï¼‰</div>
          <div class="metric-switcher">
            <el-button size="small" @click="showBubbleSettings = !showBubbleSettings" type="primary" plain>
              âš™ï¸ æ°”æ³¡è®¾ç½®
            </el-button>
            <el-button size="small" @click="toggleQuadrantLogScale('x')">
              {{ quadrantLogScaleX ? 'Xè½´çº¿æ€§' : 'Xè½´å¯¹æ•°' }}
            </el-button>
            <el-button size="small" @click="toggleQuadrantLogScale('y')">
              {{ quadrantLogScaleY ? 'Yè½´çº¿æ€§' : 'Yè½´å¯¹æ•°' }}
            </el-button>
          </div>
        </div>
        
        <!-- æ°”æ³¡å›¾é…ç½®é¢æ¿ -->
        <div v-if="showBubbleSettings" class="bubble-settings-panel">
          <div class="settings-row">
            <div class="settings-item">
              <label>æ°”æ³¡å¤§å°èŒƒå›´ï¼š</label>
              <div class="slider-wrapper">
                <span class="slider-label">æœ€å°</span>
                <el-slider v-model="bubbleSizeRange" :min="10" :max="100" :step="5" range show-stops @change="renderQuadrantChart" />
                <span class="slider-label">æœ€å¤§</span>
              </div>
              <div class="slider-value">{{ bubbleSizeRange[0] }} - {{ bubbleSizeRange[1] }}px</div>
            </div>
          </div>
          <div class="settings-row">
            <div class="settings-item">
              <label>é¢œè‰²é€æ˜åº¦èŒƒå›´ï¼š</label>
              <div class="slider-wrapper">
                <span class="slider-label">æœ€æµ…</span>
                <el-slider v-model="bubbleOpacityRange" :min="0.1" :max="1" :step="0.05" range :format-tooltip="(val) => (val * 100).toFixed(0) + '%'" @change="renderQuadrantChart" />
                <span class="slider-label">æœ€æ·±</span>
              </div>
              <div class="slider-value">{{ (bubbleOpacityRange[0] * 100).toFixed(0) }}% - {{ (bubbleOpacityRange[1] * 100).toFixed(0) }}%</div>
            </div>
          </div>
          <div class="settings-row">
            <div class="settings-item">
              <label>æ°”æ³¡å¤§å°æ˜ å°„å­—æ®µï¼š</label>
              <el-select v-model="bubbleSizeField" @change="renderQuadrantChart" style="width: 200px;">
                <el-option label="æ´»è·ƒç”¨æˆ·æ•°" value="userCount" />
                <el-option label="æ€»è´¹ç”¨" value="cost" />
                <el-option label="è°ƒç”¨æ¬¡æ•°" value="callCount" />
                <el-option label="Tokenæ¶ˆè€—" value="tokens" />
              </el-select>
            </div>
            <div class="settings-item">
              <label>é¢œè‰²æ·±æµ…æ˜ å°„å­—æ®µï¼š</label>
              <el-select v-model="bubbleColorField" @change="renderQuadrantChart" style="width: 200px;">
                <el-option label="æ€»è´¹ç”¨" value="cost" />
                <el-option label="æ´»è·ƒç”¨æˆ·æ•°" value="userCount" />
                <el-option label="è°ƒç”¨æ¬¡æ•°" value="callCount" />
                <el-option label="Tokenæ¶ˆè€—" value="tokens" />
              </el-select>
            </div>
          </div>
        </div>
        
        <div style="padding: 0 20px 10px; font-size: 12px; color: #86909C; line-height: 1.6;">
          ğŸ’¡ <strong>åˆ†ææç¤ºï¼š</strong> å›¾è¡¨ä»¥ä¸­ä½æ•°ä¸ºåˆ†ç•Œçº¿åˆ’åˆ†ä¸ºå››ä¸ªè±¡é™ã€‚ç¬¬å››è±¡é™ï¼ˆå³ä¸‹è§’ï¼‰ä¸º"æ˜æ˜Ÿåº”ç”¨"ï¼ˆé«˜è°ƒç”¨+ä½æˆæœ¬ï¼‰ï¼Œå€¼å¾—æ¨å¹¿ï¼›ç¬¬äºŒè±¡é™ï¼ˆå·¦ä¸Šè§’ï¼‰ä¸º"æˆæœ¬é»‘æ´"ï¼ˆä½è°ƒç”¨+é«˜æˆæœ¬ï¼‰ï¼Œéœ€è¦ä¼˜åŒ–ã€‚ç‚¹å‡»"æ°”æ³¡è®¾ç½®"å¯è°ƒæ•´æ°”æ³¡å¤§å°å’Œé¢œè‰²æ·±æµ…ã€‚
        </div>
        <div class="chart-container-large" id="quadrant-chart"></div>
      </div>
    </div>
    
    <!-- ç¾¤ä½“åˆ†å¸ƒ -->
    <div id="distribution-section" class="anchor-section">
      <h2 class="section-title">ğŸ“Š ç¾¤ä½“åˆ†å¸ƒ</h2>
      
      <!-- æ ¸å¿ƒæŒ‡æ ‡åˆ†å¸ƒç›´æ–¹å›¾ -->
      <div class="chart-card">
        <div class="chart-header">
          <div class="chart-title">æ™ºèƒ½ä½“æ ¸å¿ƒæŒ‡æ ‡åˆ†å¸ƒ</div>
          <div class="metric-switcher">
            <span class="filter-label">æŒ‡æ ‡ï¼š</span>
            <el-select v-model="histogramMetric" @change="updateHistogram" style="width: 180px;">
              <el-option label="æ™ºèƒ½ä½“è´¹ç”¨æ¶ˆè€—" value="cost" />
              <el-option label="æ™ºèƒ½ä½“Tokenæ¶ˆè€—" value="tokens" />
              <el-option label="æ™ºèƒ½ä½“è°ƒç”¨æ¬¡æ•°" value="calls" />
              <el-option label="æ™ºèƒ½ä½“ç”¨æˆ·æ•°" value="users" />
            </el-select>
          </div>
        </div>
        <div style="padding: 0 20px 10px; font-size: 12px; color: #86909C; line-height: 1.6;">
          ğŸ’¡ <strong>åˆ†ææç¤ºï¼š</strong> æ­¤å›¾è¡¨å±•ç¤ºæ™ºèƒ½ä½“åœ¨é€‰å®šæŒ‡æ ‡ä¸Šçš„åˆ†å¸ƒæƒ…å†µã€‚é€šè¿‡è§‚å¯Ÿåˆ†å¸ƒå½¢æ€ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨"é•¿å°¾æ•ˆåº”"ï¼ˆå¤§éƒ¨åˆ†æ™ºèƒ½ä½“é›†ä¸­åœ¨ä½å€¼åŒºé—´ï¼‰æˆ–"å¤´éƒ¨é›†ä¸­"ï¼ˆå°‘æ•°æ™ºèƒ½ä½“å æ®å¤§éƒ¨åˆ†èµ„æºï¼‰ã€‚
        </div>
        <div class="chart-container-large" id="histogram-chart"></div>
      </div>
      
      <!-- å®˜æ–¹vsç”¨æˆ·æ™ºèƒ½ä½“å¯¹æ¯” -->
      <div class="chart-card">
        <div class="chart-header">
          <div class="chart-title">å®˜æ–¹ vs. ç”¨æˆ·æ™ºèƒ½ä½“ - æˆæœ¬ä¸æ•ˆç‡å¯¹æ¯”</div>
          <div class="metric-switcher">
            <span class="filter-label">æŒ‡æ ‡ï¼š</span>
            <el-select v-model="boxplotMetric" @change="updateBoxplot" style="width: 200px;">
              <el-option label="è´¹ç”¨æ¶ˆè€—" value="cost" />
              <el-option label="æ¯æ¬¡è°ƒç”¨çš„æˆæœ¬" value="avgCostPerCall" />
              <el-option label="è°ƒç”¨æ¬¡æ•°" value="calls" />
              <el-option label="æ¯æ¬¡è°ƒç”¨çš„Tokenæ•°" value="avgTokensPerCall" />
            </el-select>
            <el-button size="small" @click="toggleLogScale">
              {{ useLogScale ? 'çº¿æ€§å°ºåº¦' : 'å¯¹æ•°å°ºåº¦' }}
            </el-button>
          </div>
        </div>
        <div style="padding: 0 20px 10px; font-size: 12px; color: #86909C; line-height: 1.6;">
          ğŸ’¡ <strong>åˆ†ææç¤ºï¼š</strong> ç®±çº¿å›¾å±•ç¤ºä¸¤ä¸ªç¾¤ä½“çš„åˆ†å¸ƒå·®å¼‚ã€‚ç®±ä½“è¡¨ç¤º50%çš„æ•°æ®èŒƒå›´ï¼ˆQ1-Q3ï¼‰ï¼Œä¸­ä½æ•°çº¿æ˜¾ç¤ºæ•°æ®é›†ä¸­è¶‹åŠ¿ã€‚çº¢è‰²åœ†ç‚¹ä¸ºå¼‚å¸¸å€¼ï¼Œç‚¹å‡»å¯æŸ¥çœ‹è¯¦æƒ…ã€‚å½“æ•°æ®æåº¦åˆ†æ•£æ—¶ï¼Œå»ºè®®åˆ‡æ¢åˆ°å¯¹æ•°å°ºåº¦ä»¥ä¾¿æ›´å¥½åœ°è§‚å¯Ÿã€‚
        </div>
        <div class="chart-container-large" id="boxplot-chart"></div>
      </div>
    </div>
    
    <!-- è¯¦ç»†æ•°æ®è¡¨ -->
    <div id="detail-table-section" class="anchor-section">
      <div class="detail-table-wrapper">
        <div class="table-header">
          <h2 class="section-title" style="margin-bottom: 0;">ğŸ“‹ æ™ºèƒ½ä½“è¯¦ç»†æ•°æ®è¡¨</h2>
          <el-button @click="showColumnDialog = true">è‡ªå®šä¹‰åˆ—</el-button>
        </div>
        
        <el-table
          :data="tableData"
          style="width: 100%"
          v-loading="loading"
          stripe
          border
          :default-sort="{ prop: 'cost', order: 'descending' }"
          @row-click="handleRowClick"
          @row-mouse-enter="handleRowHover"
          @row-mouse-leave="handleRowLeave"
        >
          <el-table-column
            v-for="col in visibleColumns"
            :key="col.prop"
            :prop="col.prop"
            :label="col.label"
            :width="col.width"
            :sortable="col.sortable !== false"
          >
            <template #default="{ row }">
              <span v-if="col.formatter" v-html="col.formatter(row)"></span>
              <span v-else>{{ row[col.prop] }}</span>
            </template>
          </el-table-column>
          
          <el-table-column label="æ“ä½œ" width="100" fixed="right">
            <template #default="{ row }">
              <el-button link type="primary" size="small" @click.stop="drillDown(row)">æŸ¥çœ‹è¯¦æƒ…</el-button>
            </template>
          </el-table-column>
        </el-table>
        
        <el-pagination
          v-model:current-page="currentPage"
          v-model:page-size="pageSize"
          :total="filteredAgentData.length"
          layout="total, sizes, prev, pager, next, jumper"
          @size-change="handlePageChange"
          @current-change="handlePageChange"
          style="margin-top: var(--spacing-4);"
        />
      </div>
    </div>
    
    <!-- è¿è¥è¡ŒåŠ¨å»ºè®® -->
    <div class="insights-section">
      <h2 class="section-title">ğŸ¯ è¿è¥è¡ŒåŠ¨å»ºè®®</h2>
      
      <div class="insight-item">
        <div class="insight-title">è¯†åˆ«æˆæœ¬é»‘æ´</div>
        <div class="insight-content">
          åœ¨ã€è¯¦ç»†æ•°æ®è¡¨ã€‘ä¸­ï¼ŒæŒ‰ æ€»èŠ±è´¹ (ï¿¥) é™åºæ’åºã€‚æŸ¥çœ‹å‰ 5 åã€‚çœ‹å®ƒä»¬çš„ èŠ±è´¹æœ€å¤šæ¨¡å‹ åˆ—ã€‚å¦‚æœéƒ½æ˜¯ GPT-4ï¼Œå†çœ‹ å¹³å‡æ¯æ¬¡è°ƒç”¨æˆæœ¬ã€‚
        </div>
        <div class="insight-action">è¡ŒåŠ¨ï¼šæ‰¾åˆ°è¿™äº›æ™ºèƒ½ä½“çš„ åˆ›å»ºè€…ï¼Œè®¨è®ºæ˜¯å¦æœ‰å¿…è¦ä½¿ç”¨æ˜‚è´µæ¨¡å‹ï¼Œæˆ–èƒ½å¦ä¼˜åŒ– Promptã€‚</div>
      </div>
      
      <div class="insight-item">
        <div class="insight-title">å‘ç°"å"æ™ºèƒ½ä½“</div>
        <div class="insight-content">
          åœ¨ã€è¯¦ç»†æ•°æ®è¡¨ã€‘ä¸­ï¼ŒæŒ‰ è°ƒç”¨æˆåŠŸç‡ (%) å‡åºæ’åºã€‚æŸ¥çœ‹æ‰€æœ‰æˆåŠŸç‡ä½äº 90% çš„æ™ºèƒ½ä½“ã€‚
        </div>
        <div class="insight-action">è¡ŒåŠ¨ï¼šè”ç³» åˆ›å»ºè€… ä¿®å¤è¿™äº›æœ‰é—®é¢˜çš„æ™ºèƒ½ä½“ï¼Œå®ƒä»¬åœ¨æµªè´¹è°ƒç”¨æ¬¡æ•°ï¼ˆå¯èƒ½ä¹Ÿåœ¨èŠ±é’±ï¼‰å¹¶å¯¼è‡´ç”¨æˆ·ä½“éªŒä¸‹é™ã€‚</div>
      </div>
      
      <div class="insight-item">
        <div class="insight-title">æ‰¾åˆ°æ˜æ˜Ÿåº”ç”¨</div>
        <div class="insight-content">
          åœ¨ã€å››è±¡é™å›¾ã€‘ä¸­ï¼Œå¯»æ‰¾"æ˜æ˜Ÿåº”ç”¨"ï¼ˆå³ä¸‹è§’ï¼šé«˜è°ƒç”¨, ä½æˆæœ¬ï¼‰ã€‚
        </div>
        <div class="insight-action">è¡ŒåŠ¨ï¼šæ€»ç»“è¿™äº›åº”ç”¨çš„å…±åŒç‚¹ï¼Œå¹¶åœ¨å…¬å¸å†…éƒ¨åˆ†äº«æœ€ä½³å®è·µã€‚</div>
      </div>
      
      <div class="insight-item">
        <div class="insight-title">å®šä½æ½œåœ¨æ»¥ç”¨</div>
        <div class="insight-content">
          åœ¨ã€è¯¦ç»†æ•°æ®è¡¨ã€‘ä¸­ï¼ŒæŒ‰ äººå‡å¯¹è¯è½®æ¬¡ é™åºæ’åºã€‚å¦‚æœæŸä¸ªæ™ºèƒ½ä½“çš„ æ´»è·ƒç”¨æˆ·æ•° å¾ˆå°‘ï¼ˆæ¯”å¦‚1-2ä¸ªï¼‰ï¼Œä½† äººå‡å¯¹è¯è½®æ¬¡ æé«˜ã€‚
        </div>
        <div class="insight-action">è¡ŒåŠ¨ï¼šè¿™å¯èƒ½æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬åœ¨åˆ·é‡ã€‚è”ç³» åˆ›å»ºè€… ç¡®è®¤å…¶è¡Œä¸ºæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</div>
      </div>
    </div>
    
    <!-- è‡ªå®šä¹‰åˆ—å¯¹è¯æ¡† -->
    <el-dialog v-model="showColumnDialog" title="è‡ªå®šä¹‰åˆ—" width="600px">
      <div style="margin-bottom: var(--spacing-4);">
        <el-checkbox v-model="checkAll" :indeterminate="isIndeterminate" @change="handleCheckAllChange">å…¨é€‰</el-checkbox>
      </div>
      <el-checkbox-group v-model="selectedColumns" @change="handleColumnChange">
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-3);">
          <el-checkbox v-for="col in allColumns" :key="col.prop" :label="col.prop">
            {{ col.label }}
          </el-checkbox>
        </div>
      </el-checkbox-group>
      <template #footer>
        <el-button @click="showColumnDialog = false">å–æ¶ˆ</el-button>
        <el-button type="primary" @click="saveColumnSettings">ç¡®å®š</el-button>
      </template>
    </el-dialog>
  </div>
  
  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  
  <!-- Element Plus -->
  <script src="https://unpkg.com/element-plus@2.4.4/dist/index.full.js"></script>
  <script src="https://unpkg.com/@element-plus/icons-vue@2/dist/index.iife.js"></script>
  
  <!-- ECharts -->
  <script src="https://unpkg.com/echarts@5.4.3/dist/echarts.min.js"></script>
  
  <!-- å·¥å…·å‡½æ•° -->
  <script src="./assets/js/utils.js"></script>
  
  <!-- Mockæ•°æ® -->
  <script src="./assets/js/mock-data.js"></script>
  
  <!-- å›¾è¡¨é…ç½® -->
  <script src="./assets/js/charts.js"></script>
  
  <!-- ä¸»åº”ç”¨ -->
  <script src="./assets/js/agent-cost-analysis.js"></script>
</body>
</html>

