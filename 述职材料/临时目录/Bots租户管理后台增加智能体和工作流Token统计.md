「已上线」后台 - 租户管理增加智能体/工作流维度Token消耗统计



1. 需求背景与目标

目标： 为了向租户管理员提供精准、归属清晰的Token消耗数据，实现精细化的成本管理。增加智能体、工作流维度token消耗统计。

核心原则：调用者归属 (Caller Attribution)
所有新增及变更的“成本指标”（即Token消耗相关数据），均严格遵循“调用者归属”原则。

统计规则： 仅统计当前租户成员（调用者）所产生的一切Token消耗。

理由： 确保租户管理员看到的成本数据是绝对准确的，所有账单、消耗、明细都能一一对应，反映“本租户的实际开销”。

功能点

优先级

截图

指标卡：智能体token总消耗

P0



指标卡：工作流token总消耗

P0

资产明细：智能体累积token消耗

P0





​

资产明细：工作流累积token消耗

P0

水平柱状图：智能体token消耗to10

P0

和模型消耗排行榜类似



水平柱状图：工作流token消耗top10

P0

其他（四个下钻明细表）

P1



2. P0 优先级功能

2.1. 标签页一：数据总览 -> 模块三：核心资源消耗分析



2.1.1. 新增核心指标卡 (P0)

在模块三顶部新增以下两个核心指标卡片：

智能体累积Token消耗 (i)

指标值示例： 123,445

统计逻辑 (i)： 严格遵循“调用者归属”原则。统计当前租户成员在调用智能体时，该智能体自身及其调用的工作流所产生的所有Token消耗总和。

UI要求： 指标名称旁需附带 (i) 图标，鼠标悬停时展示上述“统计逻辑”文案。

新增（20251113）：智能体底层的「对话工作流」产生的token消耗，归到这个智能体本身，不作为一个单独的工作流统计

工作流累积Token消耗 (i)

指标值示例： 123,445

统计逻辑 (i)： 严格遵循“调用者归属”原则。统计当前租户成员在调用工作流时，该工作流运行所产生的所有Token消耗总和。

UI要求： 指标名称旁需附带 (i) 图标，鼠标悬停时展示上述“统计逻辑”文案。

新增（20251113）：智能体底层的「对话工作流」产生的token消耗，归到这个智能体本身，不作为一个单独的工作流统计

2.1.2. 图表规格定义与更新 (P0)



模块三的图表与列表规格定义如下：

模型消耗分析 (i)

图表类型： 水平柱状图 (Top 10)

统计逻辑： 统计当前租户成员消耗各模型的Token用量。

Y轴： 模型名称

X轴： Token用量

钻取功能 (P1)： 标题旁增加 [查看全部] 按钮，为P1功能预留入口。

智能体消耗分析 (i) (新增)

图表类型： 水平柱状图 (Top 10)

统计逻辑： 统计当前租户成员消耗智能体的Token用量。

Y轴： 智能体名称

X轴： Token用量

钻取功能 (P1)： 标题旁增加 [查看全部] 按钮，为P1功能预留入口。

新增（20251113）：智能体底层的「对话工作流」产生的token消耗，归到这个智能体本身，不作为一个单独的工作流统计

工作流消耗分析 (i) (新增)

图表类型： 水平柱状图 (Top 10)

统计逻辑： 统计当前租户成员消耗工作流的Token用量。

Y轴： 工作流名称

X轴： Token用量

钻取功能 (P1)： 标题旁增加 [查看全部] 按钮，为P1功能预留入口。

新增（20251113）：智能体底层的「对话工作流」产生的token消耗，归到这个智能体本身，不作为一个单独的工作流统计。工作流维度的统计，不展示这个「对话工作流」。

成员Token消耗 Top 10

图表类型： 列表

统计逻辑： 统计当前租户成员中Token消耗排名前10的用户。

列表列： 成员（头像+名称）、Token消耗量。

钻取功能 (P1)： 标题旁增加 [查看全部] 按钮，为P1功能预留入口。

2.2. 标签页二：租户资产明细 (P0)

2.2.1. “热度指标”与“成本指标”

在本页签中，为明确统计口径，对不同类型的指标进行区分说明：

热度指标 (i)

包含： 运行次数, 用户数, 累积对话次数

统计口径： 统计全平台（含租户外）。

UI要求： 在对应列表列的表头上增加 (i) 图标，Hover时展示文案：“统计全平台（含租户外）”。

成本指标 (i)

包含： 累积Token消耗 (新增字段)

统计口径： 仅统计当前租户成员（调用者归属）。

UI要求： 在对应列表列的表头上增加 (i) 图标，Hover时展示文案：“仅统计当前租户成员消耗”。

2.2.2. 列表列规格变更





智能体 (Agent) 列表

累积对话次数 / 用户数：维持不变（全平台统计）。

新增 累积Token消耗 列： 仅统计本租户成员的消耗。

工作流 (Workflow) 列表

运行次数：维持不变（全平台统计）。

新增 累积Token消耗 列： 仅统计本租户成员的消耗。

3. P1 优先级功能：消耗分析明细 (钻取功能)

本章节定义了 2.1.2 中 [查看全部] 按钮点击后弹出的明细表规格。

3.1. 弹窗：模型消耗明细

触发： 点击“模型消耗分析”图表标题旁的 [查看全部] 按钮。

弹窗标题： “模型消耗明细”

分析目的： 帮助管理员一览当前租户在筛选时间内，所有语言模型的Token消耗分布。用于定位成本最高的模型，以便进行成本优化或模型策略调整。

功能：

搜索： 支持按“模型名称”模糊搜索；支持时间范围搜索（默认回填数据总览顶部的时间）。

默认排序： 按“Token总消耗”降序排列。

列表列规格：

列名

描述

模型名称

模型的唯一标识名称，例如 "gpt-4o"。

Token总消耗

该模型在筛选时间内的Token消耗总和。

输入Token

该模型在筛选时间内的输入Token数。

输出Token

该模型在筛选时间内的输出Token数。

消耗占比 (i)

Token总消耗 / (当前租户在筛选时间内所有模型的Token总消耗)。 

UI要求：此列提供 (i) 图标，Hover显示计算公式。

3.2. 弹窗：智能体消耗明细 (Token)

触发： 点击“智能体消耗分析”图表标题旁的 [查看全部] 按钮。

弹窗标题： “智能体消耗明细 (Token)”

分析目的： 帮助管理员一览当前租户在筛选时间内，所有智能体的Token消耗详情。用于定位消耗最高的智能体，以便进行优化或评估其价值。

功能：

搜索： 支持按“智能体名称”模糊搜索；支持时间范围搜索。

排序： 支持按“Token总消耗”（默认降序）、“输入Token”、“输出Token”排序。

默认排序： 按“Token总消耗”降序排列。

列表列规格：

列名

描述

智能体名称

智能体的名称。

Token总消耗

在筛选时间内的Token消耗总和。

输入Token

在筛选时间内的输入Token数。

输出Token

在筛选时间内的输出Token数。

创建时间

智能体的创建时间。

创建人

智能体的创建

3.3. 弹窗：工作流消耗明细 (Token)

触发： 点击“工作流消耗分析”图表标题旁的 [查看全部] 按钮。

弹窗标题： “工作流消耗明细 (Token)”

分析目的： 帮助管理员一览当前租户在筛选时间内，所有工作流的Token消耗详情。用于定位消耗最高的工作流。

功能：

搜索： 支持按“工作流名称”模糊搜索；支持时间范围搜索。

排序： 支持按“Token总消耗”（默认降序）、“输入Token”、“输出Token”排序。

默认排序： 按“Token总消耗”降序排列。

列表列规格：

列名

描述

工作流名称

智能体的名称。

Token总消耗

在筛选时间内的Token消耗总和。

输入Token

在筛选时间内的输入Token数。

输出Token

在筛选时间内的输出Token数。

创建时间

工作流的创建时间。

创建人

工作流的创建人，头像+名称

3.4. 弹窗：成员Token消耗排行

触发： 点击“成员Token消耗 Top 10”列表标题旁的 [查看全部] 按钮。

弹窗标题： “成员Token消耗排行”

分析目的： 帮助管理员一览当前租户在筛选时间内，所有成员的Token消耗排行。用于定位高消耗用户，了解团队成员的资源使用情况。

功能：

搜索： 支持按“成员”（名称/邮箱/mis/手机）模糊搜索；支持时间范围搜索。

排序： 支持按“Token总消耗”（默认降序）、“输入Token”、“输出Token”排序。

默认排序： 按“Token总消耗”降序排列。

列表列规格：

列名

描述

排行

按Token总消耗降序排列的数字排名。

成员

用户的头像和名称。

Token总消耗

该成员在筛选时间内的Token消耗总和。

输入Token

该成员在筛选时间内的输入Token数。

输出Token

该成员在筛选时间内的输出Token数。